        <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-11>immediate user selection</a>.</p>

        <p>Otherwise, run the appropriate step from the following list:</p>

        <dl class=switch><dt>If the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-12>immediate user selection</a> is a text control (e.g.,
         <code id=drag-and-drop-processing-model:the-textarea-element><a href=#the-textarea-element>textarea</a></code>, or an <code id=drag-and-drop-processing-model:the-input-element><a href=#the-input-element>input</a></code> element whose <code id=drag-and-drop-processing-model:attr-input-type><a href=#attr-input-type>type</a></code> attribute is in the <a href="#text-(type=text)-state-and-search-state-(type=search)" id="drag-and-drop-processing-model:text-(type=text)-state-and-search-state-(type=search)">Text</a> state) or an <a id=drag-and-drop-processing-model:editing-host href=https://w3c.github.io/editing/execCommand.html#editing-host data-x-internal=editing-host>editing host</a> or
         <a id=drag-and-drop-processing-model:editable href=https://w3c.github.io/editing/execCommand.html#editable data-x-internal=editable>editable</a> element, and the <a href=#drag-data-store-item-list id=drag-and-drop-processing-model:drag-data-store-item-list-6>drag data store item list</a> has an item
         with <a href=#the-drag-data-item-type-string id=drag-and-drop-processing-model:the-drag-data-item-type-string-6>the drag data item type string</a> "<code id=drag-and-drop-processing-model:text/plain-2><a data-x-internal=text/plain href=https://tools.ietf.org/html/rfc2046#section-4.1.3>text/plain</a></code>" and <a href=#the-drag-data-item-kind id=drag-and-drop-processing-model:the-drag-data-item-kind-5>the
         drag data item kind</a> <i>Plain Unicode string</i><dd><p>Set the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-10>current target element</a> to the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-13>immediate user
         selection</a> anyway.<dt>If the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-14>immediate user selection</a> is an element with a <code id=drag-and-drop-processing-model:the-dropzone-attribute><a href=#the-dropzone-attribute>dropzone</a></code> attribute that <a href=#concept-dropzone-match id=drag-and-drop-processing-model:concept-dropzone-match>matches</a> the <a href=#drag-data-store id=drag-and-drop-processing-model:drag-data-store-2>drag data store</a><dd><p>Set the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-11>current target element</a> to the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-15>immediate user
         selection</a> anyway.<dt>If the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-16>immediate user selection</a> is an element that itself has an ancestor
         element with a <code id=drag-and-drop-processing-model:the-dropzone-attribute-2><a href=#the-dropzone-attribute>dropzone</a></code> attribute that <a href=#concept-dropzone-match id=drag-and-drop-processing-model:concept-dropzone-match-2>matches</a> the <a href=#drag-data-store id=drag-and-drop-processing-model:drag-data-store-3>drag data store</a><dd>

          <p>Let <var>new target</var> be the nearest (deepest) such ancestor element.</p>

          <p>If the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-17>immediate user selection</a> is <var>new target</var>, then leave the
          <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-12>current target element</a> unchanged.</p>

          <p>Otherwise, <a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-5>fire a DND event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragenter-2><a href=#event-dnd-dragenter>dragenter</a></code> at <var>new target</var>, with the current
          <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-13>current target element</a> as the specific <var>related target</var>. Then, set
          the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-14>current target element</a> to <var>new target</var>, regardless of whether
          that event was canceled or not.</p>

         <dt>If the <a href=#immediate-user-selection id=drag-and-drop-processing-model:immediate-user-selection-18>immediate user selection</a> is <a href=#the-body-element-2 id=drag-and-drop-processing-model:the-body-element-2>the body element</a><dd><p>Leave the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-15>current target element</a> unchanged.<dt>Otherwise<dd>

          <p><a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-6>Fire a DND event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragenter-3><a href=#event-dnd-dragenter>dragenter</a></code>
          at <a href=#the-body-element-2 id=drag-and-drop-processing-model:the-body-element-2-2>the body element</a>, if there is one, or at the <code id=drag-and-drop-processing-model:document-2><a href=#document>Document</a></code> object,
          if not. Then, set the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-16>current target element</a> to <a href=#the-body-element-2 id=drag-and-drop-processing-model:the-body-element-2-3>the body
          element</a>, regardless of whether that event was canceled or not.</p>

         </dl>

       </dl>

     <li>

      <p>If the previous step caused the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-17>current target element</a> to change, and if the
      previous target element was not null or a part of a non-DOM document, then <a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-7>fire a DND
      event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragleave><a href=#event-dnd-dragleave>dragleave</a></code> at the previous target
      element, with the new <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-18>current target element</a> as the specific <var>related
      target</var>.</p>

     <li>

      <p>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-19>current target element</a> is a DOM element, then <a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-8>fire a DND
      event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragover><a href=#event-dnd-dragover>dragover</a></code> at this <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-20>current
      target element</a>.</p>

      <p>If the <code id=drag-and-drop-processing-model:event-dnd-dragover-2><a href=#event-dnd-dragover>dragover</a></code> event is not canceled, run the
      appropriate step from the following list:</p>

      <dl class=switch><dt>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-21>current target element</a> is a text control (e.g.,
       <code id=drag-and-drop-processing-model:the-textarea-element-2><a href=#the-textarea-element>textarea</a></code>, or an <code id=drag-and-drop-processing-model:the-input-element-2><a href=#the-input-element>input</a></code> element whose <code id=drag-and-drop-processing-model:attr-input-type-2><a href=#attr-input-type>type</a></code> attribute is in the <a href="#text-(type=text)-state-and-search-state-(type=search)" id="drag-and-drop-processing-model:text-(type=text)-state-and-search-state-(type=search)-2">Text</a> state) or an <a id=drag-and-drop-processing-model:editing-host-2 href=https://w3c.github.io/editing/execCommand.html#editing-host data-x-internal=editing-host>editing host</a> or
       <a id=drag-and-drop-processing-model:editable-2 href=https://w3c.github.io/editing/execCommand.html#editable data-x-internal=editable>editable</a> element, and the <a href=#drag-data-store-item-list id=drag-and-drop-processing-model:drag-data-store-item-list-7>drag data store item list</a> has an item
       with <a href=#the-drag-data-item-type-string id=drag-and-drop-processing-model:the-drag-data-item-type-string-7>the drag data item type string</a> "<code id=drag-and-drop-processing-model:text/plain-3><a data-x-internal=text/plain href=https://tools.ietf.org/html/rfc2046#section-4.1.3>text/plain</a></code>" and <a href=#the-drag-data-item-kind id=drag-and-drop-processing-model:the-drag-data-item-kind-6>the drag
       data item kind</a> <i>Plain Unicode string</i><dd><p>Set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-2>current drag operation</a> to either "<code id=drag-and-drop-processing-model:concept-current-drag-operation-copy><a href=#concept-current-drag-operation-copy>copy</a></code>" or "<code id=drag-and-drop-processing-model:concept-current-drag-operation-move><a href=#concept-current-drag-operation-move>move</a></code>", as appropriate given the platform
       conventions.<dt>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-22>current target element</a> is an element with a <code id=drag-and-drop-processing-model:the-dropzone-attribute-3><a href=#the-dropzone-attribute>dropzone</a></code> attribute that <a href=#concept-dropzone-match id=drag-and-drop-processing-model:concept-dropzone-match-3>matches</a> the <a href=#drag-data-store id=drag-and-drop-processing-model:drag-data-store-4>drag data store</a> and <a href=#concept-dropzone-operation id=drag-and-drop-processing-model:concept-dropzone-operation>specifies an operation</a><dd><p>Set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-3>current drag operation</a> to the operation <a href=#concept-dropzone-operation id=drag-and-drop-processing-model:concept-dropzone-operation-2>specified</a> by the <code id=drag-and-drop-processing-model:the-dropzone-attribute-4><a href=#the-dropzone-attribute>dropzone</a></code> attribute of the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-23>current target
       element</a>.</p>


       <dt>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-24>current target element</a> is an element with a <code id=drag-and-drop-processing-model:the-dropzone-attribute-5><a href=#the-dropzone-attribute>dropzone</a></code> attribute that <a href=#concept-dropzone-match id=drag-and-drop-processing-model:concept-dropzone-match-4>matches</a> the <a href=#drag-data-store id=drag-and-drop-processing-model:drag-data-store-5>drag data store</a> and does not
       <a href=#concept-dropzone-operation id=drag-and-drop-processing-model:concept-dropzone-operation-3>specify an operation</a><dd><p>Set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-4>current drag operation</a> to "<code id=drag-and-drop-processing-model:concept-current-drag-operation-copy-2><a href=#concept-current-drag-operation-copy>copy</a></code>".</p>


       <dt>Otherwise<dd><p>Reset the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-5>current drag operation</a> to "<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-3><a href=#concept-current-drag-operation-none>none</a></code>".</dl>

      <p>Otherwise (if the <code id=drag-and-drop-processing-model:event-dnd-dragover-3><a href=#event-dnd-dragover>dragover</a></code> event <em>is</em>
      canceled), set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-6>current drag operation</a> based on the values of the <code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed><a href=#dom-datatransfer-effectallowed>effectAllowed</a></code> and <code id=drag-and-drop-processing-model:dom-datatransfer-dropeffect><a href=#dom-datatransfer-dropeffect>dropEffect</a></code> attributes of the
      <code id=drag-and-drop-processing-model:dragevent><a href=#dragevent>DragEvent</a></code> object's <code id=drag-and-drop-processing-model:dom-dragevent-datatransfer><a href=#dom-dragevent-datatransfer>dataTransfer</a></code>
      object as they stood after the event <a href=https://dom.spec.whatwg.org/#concept-event-dispatch id=drag-and-drop-processing-model:concept-event-dispatch data-x-internal=concept-event-dispatch>dispatch</a>
      finished, as per the following table:</p>

      <table><thead><tr><th><code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-2><a href=#dom-datatransfer-effectallowed>effectAllowed</a></code><th><code id=drag-and-drop-processing-model:dom-datatransfer-dropeffect-2><a href=#dom-datatransfer-dropeffect>dropEffect</a></code><th>Drag operation<tbody><tr><td>"<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-uninitialized><a href=#dom-datatransfer-effectallowed-uninitialized>uninitialized</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-copy><a href=#dom-datatransfer-effectallowed-copy>copy</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-copylink><a href=#dom-datatransfer-effectallowed-copylink>copyLink</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-copymove><a href=#dom-datatransfer-effectallowed-copymove>copyMove</a></code>", or "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-all><a href=#dom-datatransfer-effectallowed-all>all</a></code>"<td>"<code id=drag-and-drop-processing-model:dom-datatransfer-dropeffect-copy><a href=#dom-datatransfer-dropeffect-copy>copy</a></code>"<td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-copy-3><a href=#concept-current-drag-operation-copy>copy</a></code>"<tr><td>"<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-uninitialized-2><a href=#dom-datatransfer-effectallowed-uninitialized>uninitialized</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-link><a href=#dom-datatransfer-effectallowed-link>link</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-copylink-2><a href=#dom-datatransfer-effectallowed-copylink>copyLink</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-linkmove><a href=#dom-datatransfer-effectallowed-linkmove>linkMove</a></code>", or "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-all-2><a href=#dom-datatransfer-effectallowed-all>all</a></code>"<td>"<code id=drag-and-drop-processing-model:dom-datatransfer-dropeffect-link><a href=#dom-datatransfer-dropeffect-link>link</a></code>"<td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-link><a href=#concept-current-drag-operation-link>link</a></code>"<tr><td>"<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-uninitialized-3><a href=#dom-datatransfer-effectallowed-uninitialized>uninitialized</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-move><a href=#dom-datatransfer-effectallowed-move>move</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-copymove-2><a href=#dom-datatransfer-effectallowed-copymove>copyMove</a></code>", "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-linkmove-2><a href=#dom-datatransfer-effectallowed-linkmove>linkMove</a></code>", or "<code id=drag-and-drop-processing-model:dom-datatransfer-effectallowed-all-3><a href=#dom-datatransfer-effectallowed-all>all</a></code>"<td>"<code id=drag-and-drop-processing-model:dom-datatransfer-dropeffect-move><a href=#dom-datatransfer-dropeffect-move>move</a></code>"<td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-move-2><a href=#concept-current-drag-operation-move>move</a></code>"<tr><td colspan=2>Any other case<td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-4><a href=#concept-current-drag-operation-none>none</a></code>"</table>

     <li>

      <p>Otherwise, if the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-25>current target element</a> is not a DOM element, use
      platform-specific mechanisms to determine what drag operation is being performed (none, copy,
      link, or move), and set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-7>current drag operation</a> accordingly.</p>

     <li>

      <p>Update the drag feedback (e.g. the mouse cursor) to match the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-8>current drag
      operation</a>, as follows:</p>

      <table><thead><tr><th>Drag operation<th>Feedback<tbody><tr><td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-copy-4><a href=#concept-current-drag-operation-copy>copy</a></code>"<td>Data will be copied if dropped here.<tr><td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-link-2><a href=#concept-current-drag-operation-link>link</a></code>"<td>Data will be linked if dropped here.<tr><td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-move-3><a href=#concept-current-drag-operation-move>move</a></code>"<td>Data will be moved if dropped here.<tr><td>"<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-5><a href=#concept-current-drag-operation-none>none</a></code>"<td>No operation allowed, dropping here will cancel the drag-and-drop operation.</table>

     </ol>

   <li>

    <p>Otherwise, if the user ended the drag-and-drop operation (e.g. by releasing the mouse button
    in a mouse-driven drag-and-drop interface), or if the <code id=drag-and-drop-processing-model:event-dnd-drag-3><a href=#event-dnd-drag>drag</a></code>
    event was canceled, then this will be the last iteration. Run the following steps, then stop the
    drag-and-drop operation:</p>

    <ol><li>

      <p>If the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-9>current drag operation</a> is "<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-6><a href=#concept-current-drag-operation-none>none</a></code>" (no drag operation), or, if the user
      ended the drag-and-drop operation by canceling it (e.g. by hitting the <kbd>Escape</kbd> key),
      or if the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-26>current target element</a> is null, then the drag operation failed. Run
      these substeps:</p>

      <ol><li><p>Let <var>dropped</var> be false.<li><p>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-27>current target element</a> is a DOM element, <a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-9>fire a DND
       event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragleave-2><a href=#event-dnd-dragleave>dragleave</a></code> at it; otherwise, if
       it is not null, use platform-specific conventions for drag cancelation.<li><p>Set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-10>current drag operation</a> to "<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-7><a href=#concept-current-drag-operation-none>none</a></code>".</ol>

      <p>Otherwise, the drag operation might be a success; run these substeps:</p>

      <ol><li><p>Let <var>dropped</var> be true.<li><p>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-28>current target element</a> is a DOM element, <a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-10>fire a DND
       event</a> named <code id=drag-and-drop-processing-model:event-dnd-drop><a href=#event-dnd-drop>drop</a></code> at it; otherwise, use
       platform-specific conventions for indicating a drop.<li>

        <p>If the event is canceled, set the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-11>current drag operation</a> to the value of the
        <code id=drag-and-drop-processing-model:dom-datatransfer-dropeffect-3><a href=#dom-datatransfer-dropeffect>dropEffect</a></code> attribute of the
        <code id=drag-and-drop-processing-model:dragevent-2><a href=#dragevent>DragEvent</a></code> object's <code id=drag-and-drop-processing-model:dom-dragevent-datatransfer-2><a href=#dom-dragevent-datatransfer>dataTransfer</a></code>
        object as it stood after the event <a href=https://dom.spec.whatwg.org/#concept-event-dispatch id=drag-and-drop-processing-model:concept-event-dispatch-2 data-x-internal=concept-event-dispatch>dispatch</a>
        finished.</p>

        <p>Otherwise, the event is not canceled; perform the event's default action, which depends
        on the exact target as follows:</p>

        <dl class=switch><dt>If the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-29>current target element</a> is a text control (e.g.,
         <code id=drag-and-drop-processing-model:the-textarea-element-3><a href=#the-textarea-element>textarea</a></code>, or an <code id=drag-and-drop-processing-model:the-input-element-3><a href=#the-input-element>input</a></code> element whose <code id=drag-and-drop-processing-model:attr-input-type-3><a href=#attr-input-type>type</a></code> attribute is in the <a href="#text-(type=text)-state-and-search-state-(type=search)" id="drag-and-drop-processing-model:text-(type=text)-state-and-search-state-(type=search)-3">Text</a> state) or an <a id=drag-and-drop-processing-model:editing-host-3 href=https://w3c.github.io/editing/execCommand.html#editing-host data-x-internal=editing-host>editing host</a> or
         <a id=drag-and-drop-processing-model:editable-3 href=https://w3c.github.io/editing/execCommand.html#editable data-x-internal=editable>editable</a> element, and the <a href=#drag-data-store-item-list id=drag-and-drop-processing-model:drag-data-store-item-list-8>drag data store item list</a> has an item
         with <a href=#the-drag-data-item-type-string id=drag-and-drop-processing-model:the-drag-data-item-type-string-8>the drag data item type string</a> "<code id=drag-and-drop-processing-model:text/plain-4><a data-x-internal=text/plain href=https://tools.ietf.org/html/rfc2046#section-4.1.3>text/plain</a></code>" and <a href=#the-drag-data-item-kind id=drag-and-drop-processing-model:the-drag-data-item-kind-7>the
         drag data item kind</a> <i>Plain Unicode string</i><dd><p>Insert the actual data of the first item in the <a href=#drag-data-store-item-list id=drag-and-drop-processing-model:drag-data-store-item-list-9>drag data store item
         list</a> to have <a href=#the-drag-data-item-type-string id=drag-and-drop-processing-model:the-drag-data-item-type-string-9>a drag data item type
         string</a> of "<code id=drag-and-drop-processing-model:text/plain-5><a data-x-internal=text/plain href=https://tools.ietf.org/html/rfc2046#section-4.1.3>text/plain</a></code>" and <a href=#the-drag-data-item-kind id=drag-and-drop-processing-model:the-drag-data-item-kind-8>a drag
         data item kind</a> that is <i>Plain Unicode string</i> into the text control or
         <a id=drag-and-drop-processing-model:editing-host-4 href=https://w3c.github.io/editing/execCommand.html#editing-host data-x-internal=editing-host>editing host</a> or <a id=drag-and-drop-processing-model:editable-4 href=https://w3c.github.io/editing/execCommand.html#editable data-x-internal=editable>editable</a> element in a manner consistent with
         platform-specific conventions (e.g. inserting it at the current mouse cursor position, or
         inserting it at the end of the field).<dt>Otherwise<dd><p>Reset the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-12>current drag operation</a> to "<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-8><a href=#concept-current-drag-operation-none>none</a></code>".</dl>

       </ol>

     <li>

      <p><a href=#fire-a-dnd-event id=drag-and-drop-processing-model:fire-a-dnd-event-11>Fire a DND event</a> named <code id=drag-and-drop-processing-model:event-dnd-dragend><a href=#event-dnd-dragend>dragend</a></code> at the
      <a href=#source-node id=drag-and-drop-processing-model:source-node-10>source node</a>.</p>

     <li>

      <p>Run the appropriate steps from the following list as the default action of the <code id=drag-and-drop-processing-model:event-dnd-dragend-2><a href=#event-dnd-dragend>dragend</a></code> event:</p>

      <dl class=switch><dt>If <var>dropped</var> is true, the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-30>current target element</a> is a <i>text
       control</i> (see below), the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-13>current drag operation</a> is "<code id=drag-and-drop-processing-model:concept-current-drag-operation-move-4><a href=#concept-current-drag-operation-move>move</a></code>", and the source of the
       drag-and-drop operation is a selection in the DOM that is entirely contained within an
       <a id=drag-and-drop-processing-model:editing-host-5 href=https://w3c.github.io/editing/execCommand.html#editing-host data-x-internal=editing-host>editing host</a><dd><p><a id=drag-and-drop-processing-model:delete-the-selection href=https://w3c.github.io/editing/execCommand.html#delete-the-selection data-x-internal=delete-the-selection>Delete the selection</a>.<dt>If <var>dropped</var> is true, the <a href=#current-target-element id=drag-and-drop-processing-model:current-target-element-31>current target element</a> is a <i>text
       control</i> (see below), the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-14>current drag operation</a> is "<code id=drag-and-drop-processing-model:concept-current-drag-operation-move-5><a href=#concept-current-drag-operation-move>move</a></code>", and the source of the
       drag-and-drop operation is a selection in a text control<dd><p>The user agent should delete the dragged selection from the relevant text
       control.<dt>If <var>dropped</var> is false or if the <a href=#current-drag-operation id=drag-and-drop-processing-model:current-drag-operation-15>current drag operation</a> is "<code id=drag-and-drop-processing-model:concept-current-drag-operation-none-9><a href=#concept-current-drag-operation-none>none</a></code>"<dd><p>The drag was canceled. If the platform conventions dictate that this be represented to
       the user (e.g. by animating the dragged selection going back to the source of the
       drag-and-drop operation), then do so.<dt>Otherwise<dd><p>The event has no default action.</dl>

      <p>For the purposes of this step, a <i>text control</i> is a <code id=drag-and-drop-processing-model:the-textarea-element-4><a href=#the-textarea-element>textarea</a></code> element or
      an <code id=drag-and-drop-processing-model:the-input-element-4><a href=#the-input-element>input</a></code> element whose <code id=drag-and-drop-processing-model:attr-input-type-4><a href=#attr-input-type>type</a></code> attribute is in
      one of the
      <a href="#text-(type=text)-state-and-search-state-(type=search)" id="drag-and-drop-processing-model:text-(type=text)-state-and-search-state-(type=search)-4">Text</a>,
      <a href="#text-(type=text)-state-and-search-state-(type=search)" id="drag-and-drop-processing-model:text-(type=text)-state-and-search-state-(type=search)-5">Search</a>,
      <a href="#telephone-state-(type=tel)" id="drag-and-drop-processing-model:telephone-state-(type=tel)">Tel</a>,
      <a href="#url-state-(type=url)" id="drag-and-drop-processing-model:url-state-(type=url)">URL</a>,
      <a href="#e-mail-state-(type=email)" id="drag-and-drop-processing-model:e-mail-state-(type=email)">E-mail</a>,
      <a href="#password-state-(type=password)" id="drag-and-drop-processing-model:password-state-(type=password)">Password</a>, or
      <a href="#number-state-(type=number)" id="drag-and-drop-processing-model:number-state-(type=number)">Number</a>
      states.</p>


     </ol>

   </ol>

  <p class=note>User agents are encouraged to consider how to react to drags near the edge of
  scrollable regions. For example, if a user drags a link to the bottom of the <a id=drag-and-drop-processing-model:viewport href=https://drafts.csswg.org/css2/visuren.html#viewport data-x-internal=viewport>viewport</a>
  on a long page, it might make sense to scroll the page so that the user can drop the link lower on
  the page.</p>

  <p class=note>This model is independent of which <code id=drag-and-drop-processing-model:document-3><a href=#document>Document</a></code> object the nodes involved
  are from; the events are fired as described above and the rest of the processing model runs as
  described above, irrespective of how many documents are involved in the operation.</p>

  


  <h4 id=dndevents>6.7.6 Events summary<a href=#dndevents class=self-link></a></h4>

  <p><i>This section is non-normative.</i></p>

  <p>The following events are involved in the drag-and-drop
  model.</p>

  <table><thead><tr><th> Event Name <th> Target <th> Cancelable? <th> <a href=#drag-data-store-mode id=dndevents:drag-data-store-mode>Drag data store mode</a> <th> <code id=dndevents:dom-datatransfer-dropeffect><a href=#dom-datatransfer-dropeffect>dropEffect</a></code> <th> Default Action <tbody><tr><td><dfn id=event-dnd-dragstart><code>dragstart</code></dfn><td><a href=#source-node id=dndevents:source-node>Source node</a><td>✓ Cancelable<td><a href=#concept-dnd-rw id=dndevents:concept-dnd-rw>Read/write mode</a>
     
     <td>"<code id=dndevents:dom-datatransfer-dropeffect-none><a href=#dom-datatransfer-dropeffect-none>none</a></code>"<td>Initiate the drag-and-drop operation<tr><td><dfn id=event-dnd-drag><code>drag</code></dfn><td><a href=#source-node id=dndevents:source-node-2>Source node</a><td>✓ Cancelable<td><a href=#concept-dnd-p id=dndevents:concept-dnd-p>Protected mode</a>
     
     <td>"<code id=dndevents:dom-datatransfer-dropeffect-none-2><a href=#dom-datatransfer-dropeffect-none>none</a></code>"<td>Continue the drag-and-drop operation<tr><td><dfn id=event-dnd-dragenter><code>dragenter</code></dfn><td><a href=#immediate-user-selection id=dndevents:immediate-user-selection>Immediate user selection</a> or <a href=#the-body-element-2 id=dndevents:the-body-element-2>the body element</a><td>✓ Cancelable<td><a href=#concept-dnd-p id=dndevents:concept-dnd-p-2>Protected mode</a>
     
     <td><a href=#dropEffect-initialisation>Based on <code>effectAllowed</code> value</a><td>Reject <a href=#immediate-user-selection id=dndevents:immediate-user-selection-2>immediate user selection</a> as potential <a href=#current-target-element id=dndevents:current-target-element>target element</a><tr><td><dfn id=event-dnd-dragexit><code>dragexit</code></dfn><td><a href=#current-target-element id=dndevents:current-target-element-2>Previous target element</a><td>—<td><a href=#concept-dnd-p id=dndevents:concept-dnd-p-3>Protected mode</a>
     
     <td>"<code id=dndevents:dom-datatransfer-dropeffect-none-3><a href=#dom-datatransfer-dropeffect-none>none</a></code>"<td>None<tr><td><dfn id=event-dnd-dragleave><code>dragleave</code></dfn><td><a href=#current-target-element id=dndevents:current-target-element-3>Previous target element</a><td>—<td><a href=#concept-dnd-p id=dndevents:concept-dnd-p-4>Protected mode</a>
     
     <td>"<code id=dndevents:dom-datatransfer-dropeffect-none-4><a href=#dom-datatransfer-dropeffect-none>none</a></code>"<td>None<tr><td><dfn id=event-dnd-dragover><code>dragover</code></dfn><td><a href=#current-target-element id=dndevents:current-target-element-4>Current target element</a><td>✓ Cancelable<td><a href=#concept-dnd-p id=dndevents:concept-dnd-p-5>Protected mode</a>
     
     <td><a href=#dropEffect-initialisation>Based on <code>effectAllowed</code> value</a><td>Reset the <a href=#current-drag-operation id=dndevents:current-drag-operation>current drag operation</a> to "none"<tr><td><dfn id=event-dnd-drop><code>drop</code></dfn><td><a href=#current-target-element id=dndevents:current-target-element-5>Current target element</a><td>✓ Cancelable<td><a href=#concept-dnd-ro id=dndevents:concept-dnd-ro>Read-only mode</a>
     
     <td><a href=#current-drag-operation id=dndevents:current-drag-operation-2>Current drag operation</a><td>Varies<tr><td><dfn id=event-dnd-dragend><code>dragend</code></dfn><td><a href=#source-node id=dndevents:source-node-3>Source node</a><td>—<td><a href=#concept-dnd-p id=dndevents:concept-dnd-p-6>Protected mode</a>
     
     <td><a href=#current-drag-operation id=dndevents:current-drag-operation-3>Current drag operation</a><td>Varies</table>

  <p>Not shown in the above table: all these events bubble, are composed, and the <code id=dndevents:dom-datatransfer-effectallowed><a href=#dom-datatransfer-effectallowed>effectAllowed</a></code> attribute always has the value it had
  after the <code id=dndevents:event-dnd-dragstart><a href=#event-dnd-dragstart>dragstart</a></code> event, defaulting to "<code id=dndevents:dom-datatransfer-effectallowed-uninitialized><a href=#dom-datatransfer-effectallowed-uninitialized>uninitialized</a></code>" in the <code id=dndevents:event-dnd-dragstart-2><a href=#event-dnd-dragstart>dragstart</a></code> event.</p>



  <h4 id=the-draggable-attribute>6.7.7 The <dfn><code>draggable</code></dfn> attribute<a href=#the-draggable-attribute class=self-link></a></h4><div class=status><input onclick=toggleStatus(this) value=⋰ type=button><p class=bugs><strong>Spec bugs:</strong> <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=26024" title="Drag and drop <img> should give the rendered image's URL">26024</a></div>

  <p>All <a href=#html-elements id=the-draggable-attribute:html-elements>HTML elements</a> may have the <code id=the-draggable-attribute:the-draggable-attribute><a href=#the-draggable-attribute>draggable</a></code>
  content attribute set. The <code id=the-draggable-attribute:the-draggable-attribute-2><a href=#the-draggable-attribute>draggable</a></code> attribute is an
  <a href=#enumerated-attribute id=the-draggable-attribute:enumerated-attribute>enumerated attribute</a>. It has three states. The first state is <i>true</i> and it has
  the keyword <code>true</code>. The second state is <i>false</i> and it has the keyword
  <code>false</code>. The third state is <i>auto</i>; it has no keywords but it is the
  <i id=the-draggable-attribute:missing-value-default><a href=#missing-value-default>missing value default</a></i>.</p>

  <p>The <i>true</i> state means the element is draggable; the <i>false</i> state means that it is
  not. The <i>auto</i> state uses the default behavior of the user agent.</p>

  <p>An element with a <code id=the-draggable-attribute:the-draggable-attribute-3><a href=#the-draggable-attribute>draggable</a></code> attribute should also have a
  <code id=the-draggable-attribute:attr-title><a href=#attr-title>title</a></code> attribute that names the element for the purpose of
  non-visual interactions. </p>

  <dl class=domintro><dt><var>element</var> . <code id=the-draggable-attribute:dom-draggable><a href=#dom-draggable>draggable</a></code> [ = <var>value</var> ]<dd>

    <p>Returns true if the element is draggable; otherwise, returns false.</p>

    <p>Can be set, to override the default and set the <code id=the-draggable-attribute:the-draggable-attribute-4><a href=#the-draggable-attribute>draggable</a></code>
    content attribute.</p>

   </dl>

  

  <p>The <dfn id=dom-draggable><code>draggable</code></dfn> IDL attribute, whose value depends
  on the content attribute's in the way described below, controls whether or not the element is
  draggable. Generally, only text selections are draggable, but elements whose <code id=the-draggable-attribute:dom-draggable-2><a href=#dom-draggable>draggable</a></code> IDL attribute is true become draggable as well.</p>

  <p>If an element's <code id=the-draggable-attribute:the-draggable-attribute-5><a href=#the-draggable-attribute>draggable</a></code> content attribute has the state
  <i>true</i>, the <code id=the-draggable-attribute:dom-draggable-3><a href=#dom-draggable>draggable</a></code> IDL attribute must return true.</p>

  <p>Otherwise, if the element's <code id=the-draggable-attribute:the-draggable-attribute-6><a href=#the-draggable-attribute>draggable</a></code> content attribute has
  the state <i>false</i>, the <code id=the-draggable-attribute:dom-draggable-4><a href=#dom-draggable>draggable</a></code> IDL attribute must return
  false.</p>

  <p>Otherwise, the element's <code id=the-draggable-attribute:the-draggable-attribute-7><a href=#the-draggable-attribute>draggable</a></code> content attribute has
  the state <i>auto</i>. If the element is an <code id=the-draggable-attribute:the-img-element><a href=#the-img-element>img</a></code> element, an <code id=the-draggable-attribute:the-object-element><a href=#the-object-element>object</a></code>
  element that <a href=#represents id=the-draggable-attribute:represents>represents</a> an image, or an <code id=the-draggable-attribute:the-a-element><a href=#the-a-element>a</a></code> element with an <code id=the-draggable-attribute:attr-hyperlink-href><a href=#attr-hyperlink-href>href</a></code> content attribute, the <code id=the-draggable-attribute:dom-draggable-5><a href=#dom-draggable>draggable</a></code> IDL attribute must return true; otherwise, the <code id=the-draggable-attribute:dom-draggable-6><a href=#dom-draggable>draggable</a></code> IDL attribute must return false.</p>

  <p>If the <code id=the-draggable-attribute:dom-draggable-7><a href=#dom-draggable>draggable</a></code> IDL attribute is set to the value false,
  the <code id=the-draggable-attribute:the-draggable-attribute-8><a href=#the-draggable-attribute>draggable</a></code> content attribute must be set to the literal
  value "<code>false</code>". If the <code id=the-draggable-attribute:dom-draggable-8><a href=#dom-draggable>draggable</a></code> IDL
  attribute is set to the value true, the <code id=the-draggable-attribute:the-draggable-attribute-9><a href=#the-draggable-attribute>draggable</a></code> content
  attribute must be set to the literal value "<code>true</code>".</p>

  


  <h4 id=the-dropzone-attribute>6.7.8 The <dfn><code>dropzone</code></dfn> attribute<a href=#the-dropzone-attribute class=self-link></a></h4>

  <p>All <a href=#html-elements id=the-dropzone-attribute:html-elements>HTML elements</a> may have the <code id=the-dropzone-attribute:the-dropzone-attribute><a href=#the-dropzone-attribute>dropzone</a></code> content
  attribute set. When specified, its value must be an <a href=#unordered-set-of-unique-space-separated-tokens id=the-dropzone-attribute:unordered-set-of-unique-space-separated-tokens>unordered set of unique space-separated
  tokens</a> that are <a id=the-dropzone-attribute:ascii-case-insensitive href=https://infra.spec.whatwg.org/#ascii-case-insensitive data-x-internal=ascii-case-insensitive>ASCII case-insensitive</a>. The allowed values are the
  following:</p>

  <dl><dt><dfn id=attr-dropzone-copy><code>copy</code></dfn><dd><p>Indicates that dropping an accepted item on the element will result in a copy of the
   dragged data.</p>


   <dt><dfn id=attr-dropzone-move><code>move</code></dfn><dd><p>Indicates that dropping an accepted item on the element will result in the dragged data
   being moved to the new location.</p>


   <dt><dfn id=attr-dropzone-link><code>link</code></dfn><dd><p>Indicates that dropping an accepted item on the element will result in a link to the
   original data.</p>


   <dt>Any keyword with eight characters or more, beginning with an <a id=the-dropzone-attribute:ascii-case-insensitive-2 href=https://infra.spec.whatwg.org/#ascii-case-insensitive data-x-internal=ascii-case-insensitive>ASCII
   case-insensitive</a> match for the string "<code>string:</code>"<dd><p>Indicates that items with <a href=#the-drag-data-item-kind id=the-dropzone-attribute:the-drag-data-item-kind>the drag data item kind</a> <i>Plain Unicode string</i>
   and <a href=#the-drag-data-item-type-string id=the-dropzone-attribute:the-drag-data-item-type-string>the drag data item type string</a> set to a value that matches the remainder of the
   keyword are accepted.<dt>Any keyword with six characters or more, beginning with an <a id=the-dropzone-attribute:ascii-case-insensitive-3 href=https://infra.spec.whatwg.org/#ascii-case-insensitive data-x-internal=ascii-case-insensitive>ASCII
   case-insensitive</a> match for the string "<code>file:</code>"<dd><p>Indicates that items with <a href=#the-drag-data-item-kind id=the-dropzone-attribute:the-drag-data-item-kind-2>the drag data item kind</a> <i>File</i> and <a href=#the-drag-data-item-type-string id=the-dropzone-attribute:the-drag-data-item-type-string-2>the
   drag data item type string</a> set to a value that matches the remainder of the keyword are
   accepted.</dl>

  <p>The <code id=the-dropzone-attribute:the-dropzone-attribute-2><a href=#the-dropzone-attribute>dropzone</a></code> content attribute's values must not have more
  than one of the three feedback values (<code id=the-dropzone-attribute:attr-dropzone-copy><a href=#attr-dropzone-copy>copy</a></code>, <code id=the-dropzone-attribute:attr-dropzone-move><a href=#attr-dropzone-move>move</a></code>, and <code id=the-dropzone-attribute:attr-dropzone-link><a href=#attr-dropzone-link>link</a></code>)
  specified. If none are specified, the <code id=the-dropzone-attribute:attr-dropzone-copy-2><a href=#attr-dropzone-copy>copy</a></code> value is
  implied.</p>

  <p>An element with a <code id=the-dropzone-attribute:the-dropzone-attribute-3><a href=#the-dropzone-attribute>dropzone</a></code> attribute should also have a
  <code id=the-dropzone-attribute:attr-title><a href=#attr-title>title</a></code> attribute that names the element for the purpose of
  non-visual interactions. </p>

  

  <p>A <code id=the-dropzone-attribute:the-dropzone-attribute-4><a href=#the-dropzone-attribute>dropzone</a></code> attribute <dfn id=concept-dropzone-match>matches a drag data store</dfn> if the <a href=#dropzone-processing-steps id=the-dropzone-attribute:dropzone-processing-steps><code>dropzone</code> processing steps</a> result in a match.</p>

  <p>A <code id=the-dropzone-attribute:the-dropzone-attribute-5><a href=#the-dropzone-attribute>dropzone</a></code> attribute <dfn id=concept-dropzone-operation>specifies an operation</dfn> if the <a href=#dropzone-processing-steps id=the-dropzone-attribute:dropzone-processing-steps-2><code>dropzone</code> processing steps</a> result in a specified operation. The
  specified operation is as given by those steps.</p>

  <p>The <dfn id=dropzone-processing-steps><code>dropzone</code> processing steps</dfn> are as follows.
  They either result in a match or not, and separate from this result either in a specified
  operation or not, as defined below.</p>

  <ol><li><p>Let <var>value</var> be the value of the <code id=the-dropzone-attribute:the-dropzone-attribute-6><a href=#the-dropzone-attribute>dropzone</a></code> attribute.<li><p>Let <var>keywords</var> be the result of <a href=#split-a-string-on-spaces id=the-dropzone-attribute:split-a-string-on-spaces>splitting <var>value</var> on spaces</a>.<li><p>Let <var>matched</var> be false.<li><p>Let <var>operation</var> be unspecified.<li>

    <p>For each value in <var>keywords</var>, if any, in the order that they were found in
    <var>value</var>, run the following steps.</p>

    <ol><li><p>Let <var>keyword</var> be the keyword.<li>

      <p>If <var>keyword</var> is one of "<code id=the-dropzone-attribute:attr-dropzone-copy-3><a href=#attr-dropzone-copy>copy</a></code>",
      "<code id=the-dropzone-attribute:attr-dropzone-move-2><a href=#attr-dropzone-move>move</a></code>", or "<code id=the-dropzone-attribute:attr-dropzone-link-2><a href=#attr-dropzone-link>link</a></code>", then: run the following substeps:</p>

      <ol><li><p>If <var>operation</var> is still unspecified, then let <var>operation</var> be the string given by <var>keyword</var>.<li><p>Skip to the step labeled <i>end of keyword</i> below.</ol>

     <li><p>If <var>keyword</var> does not contain a U+003A COLON character (:), or if the
     first such character in <var>keyword</var> is either the first character or the last
     character in the string, then skip to the step labeled <i>end of keyword</i> below.<li><p>Let <var>kind code</var> be the substring of <var>keyword</var> from
     the first character in the string to the last character in the string that is before the first
     U+003A COLON character (:) in the string, <a id=the-dropzone-attribute:converted-to-ascii-lowercase href=https://infra.spec.whatwg.org/#ascii-lowercase data-x-internal=converted-to-ascii-lowercase>converted to ASCII lowercase</a>.</p>

     <li>

      <p>Jump to the appropriate step from the list below, based on the value of <var>kind
      code</var>:</p>

      <dl class=switch><dt>If <var>kind code</var> is the string "<code>string</code>"<dd>

        <p>Let <var>kind</var> be <i>Plain Unicode string</i>.</p>

       <dt>If <var>kind code</var> is the string "<code>file</code>"<dd>

        <p>Let <var>kind</var> be <i>File</i>.</p>

       <dt>Otherwise<dd>

        <p>Skip to the step labeled <i>end of keyword</i> below.</p>

       </dl>

     <li><p>Let <var>type</var> be the substring of <var>keyword</var> from the
     first character after the first U+003A COLON character (:) in the string, to the last character
     in the string, <a id=the-dropzone-attribute:converted-to-ascii-lowercase-2 href=https://infra.spec.whatwg.org/#ascii-lowercase data-x-internal=converted-to-ascii-lowercase>converted to ASCII lowercase</a>.<li><p>If there exist any items in the <a href=#drag-data-store-item-list id=the-dropzone-attribute:drag-data-store-item-list>drag data store item list</a> whose <a href=#the-drag-data-item-kind id=the-dropzone-attribute:the-drag-data-item-kind-3>drag data item kind</a> is  the
     kind given in <var>kind</var> and
     whose <a href=#the-drag-data-item-type-string id=the-dropzone-attribute:the-drag-data-item-type-string-3>drag data item type string</a> is <var>type</var>, then let <var>matched</var> be true.<li><p><i>End of keyword</i>: Go on to the next keyword, if any, or the next step in the
     overall algorithm, if there are no more.</ol>

   <li>

    <p>The algorithm results in a match if <var>matched</var> is true, and does not
    otherwise.</p>

    <p>The algorithm results in a specified operation if <var>operation</var> is not
    unspecified. The specified operation, if one is specified, is the one given by <var>operation</var>.</p>

   </ol>

  <p>The <dfn id=dom-dropzone><code>dropzone</code></dfn> IDL attribute must
  <a href=#reflect id=the-dropzone-attribute:reflect>reflect</a> the content attribute of the same name.</p>

  <p>The <a href=https://dom.spec.whatwg.org/#concept-supported-tokens id=the-dropzone-attribute:concept-supported-tokens data-x-internal=concept-supported-tokens>supported tokens</a> for
  <code id=the-dropzone-attribute:the-dropzone-attribute-7><a href=#the-dropzone-attribute>dropzone</a></code> are the allowed values defined for the
  <code id=the-dropzone-attribute:the-dropzone-attribute-8><a href=#the-dropzone-attribute>dropzone</a></code> attribute that are supported by the user agent.</p>

  

  <div class=example>

   <p>In this example, a <code id=the-dropzone-attribute:the-div-element><a href=#the-div-element>div</a></code> element is made into a drop target for image files using
   the <code id=the-dropzone-attribute:the-dropzone-attribute-9><a href=#the-dropzone-attribute>dropzone</a></code> attribute. Images dropped into the target are
   then displayed.</p>

   <pre>&lt;div dropzone="copy file:image/png file:image/gif file:image/jpeg" ondrop="receive(event, this)">
 &lt;p>Drop an image here to have it displayed.&lt;/p>
&lt;/div>
&lt;script>
 function receive(event, element) {
   var data = event.dataTransfer.items;
   for (var i = 0; i &lt; data.length; i += 1) {
     if ((data[i].kind == 'file') &amp;&amp; (data[i].type.match('^image/'))) {
       var img = new Image();
       img.src = window.createObjectURL(data[i].getAsFile());
       element.appendChild(img);
     }
   }
 }
&lt;/script></pre>

  </div>






  

  <h4 id=security-risks-in-the-drag-and-drop-model>6.7.9 Security risks in the drag-and-drop model<a href=#security-risks-in-the-drag-and-drop-model class=self-link></a></h4>

  <p>User agents must not make the data added to the <code id=security-risks-in-the-drag-and-drop-model:datatransfer><a href=#datatransfer>DataTransfer</a></code> object during the
  <code id=security-risks-in-the-drag-and-drop-model:event-dnd-dragstart><a href=#event-dnd-dragstart>dragstart</a></code> event available to scripts until the <code id=security-risks-in-the-drag-and-drop-model:event-dnd-drop><a href=#event-dnd-drop>drop</a></code> event, because otherwise, if a user were to drag sensitive
  information from one document to a second document, crossing a hostile third document in the
  process, the hostile document could intercept the data.</p>

  <p>For the same reason, user agents must consider a drop to be successful only if the user
  specifically ended the drag operation — if any scripts end the drag operation, it must be
  considered unsuccessful (canceled) and the <code id=security-risks-in-the-drag-and-drop-model:event-dnd-drop-2><a href=#event-dnd-drop>drop</a></code> event must not be
  fired.</p>

  <p>User agents should take care to not start drag-and-drop operations in response to script
  actions. For example, in a mouse-and-window environment, if a script moves a window while the user
  has their mouse button depressed, the UA would not consider that to start a drag. This is important
  because otherwise UAs could cause data to be dragged from sensitive sources and dropped into
  hostile documents without the user's consent.</p>

  <p>User agents should filter potentially active (scripted) content (e.g. HTML) when it is dragged
  and when it is dropped, using a safelist of known-safe features. Similarly, <a href=https://url.spec.whatwg.org/#syntax-url-relative id=security-risks-in-the-drag-and-drop-model:relative-url data-x-internal=relative-url>relative URLs</a> should be turned into absolute URLs to avoid references changing in
  unexpected ways. This specification does not specify how this is performed.</p>

  <div class=example>

   <p>Consider a hostile page providing some content and getting the user to select and drag and
   drop (or indeed, copy and paste) that content to a victim page's <code id=security-risks-in-the-drag-and-drop-model:attr-contenteditable><a href=#attr-contenteditable>contenteditable</a></code> region. If the browser does not ensure that
   only safe content is dragged, potentially unsafe content such as scripts and event handlers in
   the selection, once dropped (or pasted) into the victim site, get the privileges of the victim
   site. This would thus enable a cross-site scripting attack.</p>

  </div>

  




  <h2 id=browsers>7 Loading Web pages<a href=#browsers class=self-link></a></h2>

  

  <p>This section describes features that apply most directly to Web browsers. Having said that,
  except where specified otherwise, the requirements defined in this section <em>do</em> apply to
  all user agents, whether they are Web browsers or not.</p>

  



  <h3 id=windows>7.1 Browsing contexts<a href=#windows class=self-link></a></h3>

  <p>A <dfn id=browsing-context data-export="">browsing context</dfn> is an environment in which <code id=windows:document><a href=#document>Document</a></code>
  objects are presented to the user.</p>

  <p class=note>A tab or window in a Web browser typically contains a <a href=#browsing-context id=windows:browsing-context>browsing
  context</a>, as does an <code id=windows:the-iframe-element><a href=#the-iframe-element>iframe</a></code> or <code id=windows:frame><a href=#frame>frame</a></code>s in a
  <code id=windows:frameset><a href=#frameset>frameset</a></code>.</p>

  <p>A <a href=#browsing-context id=windows:browsing-context-2>browsing context</a> has a corresponding <code id=windows:windowproxy><a href=#windowproxy>WindowProxy</a></code> object.</p>

  <p>A <a href=#browsing-context id=windows:browsing-context-3>browsing context</a> has a <a href=#session-history id=windows:session-history>session history</a>, which lists the
  <code id=windows:document-2><a href=#document>Document</a></code> objects that the <a href=#browsing-context id=windows:browsing-context-4>browsing context</a> has presented, is presenting,
  or will present. At any time, one <code id=windows:document-3><a href=#document>Document</a></code> in each <a href=#browsing-context id=windows:browsing-context-5>browsing context</a> is
  designated the <dfn id=active-document data-export="">active document</dfn>.
  A <dfn data-dfn-for=Document id=concept-document-bc data-lt="browsing context" data-export=""><code>Document</code>'s browsing context</dfn> is the <a href=#browsing-context id=windows:browsing-context-6>browsing context</a>
  whose <a href=#session-history id=windows:session-history-2>session history</a> contains the <code id=windows:document-4><a href=#document>Document</a></code>, if any such browsing
  context exists and has not been <a href=#a-browsing-context-is-discarded id=windows:a-browsing-context-is-discarded>discarded</a>.</p>

  <p class=note>In general, there is a 1-to-1 mapping from the <code id=windows:window><a href=#window>Window</a></code> object to the
  <code id=windows:document-5><a href=#document>Document</a></code> object, as long as the <code id=windows:document-6><a href=#document>Document</a></code> object has a <a href=#concept-document-bc id=windows:concept-document-bc>browsing context</a>. There are two exceptions. First, a
  <code id=windows:window-2><a href=#window>Window</a></code> can be reused for the presentation of a second <code id=windows:document-7><a href=#document>Document</a></code> in the
  same <a href=#browsing-context id=windows:browsing-context-7>browsing context</a>, such that the mapping is then 1-to-2. This occurs when a
  <a href=#browsing-context id=windows:browsing-context-8>browsing context</a> is <a href=#navigate id=windows:navigate>navigated</a> from the initial
  <code id=windows:about:blank><a href=#about:blank>about:blank</a></code> <code id=windows:document-8><a href=#document>Document</a></code> to another, with <a href=#replacement-enabled id=windows:replacement-enabled>replacement enabled</a>.
  Second, a <code id=windows:document-9><a href=#document>Document</a></code> can end up being reused for several <code id=windows:window-3><a href=#window>Window</a></code> objects
  when the <code id=windows:dom-document-open><a href=#dom-document-open>document.open()</a></code> method is used, such that the
  mapping is then many-to-1.</p>

  <p class=note>A <code id=windows:document-10><a href=#document>Document</a></code> does not necessarily have a <a href=#concept-document-bc id=windows:concept-document-bc-2>browsing context</a> associated with it. In particular, data
  mining tools are likely to never instantiate browsing contexts. A <code id=windows:document-11><a href=#document>Document</a></code> created
  using an API such as <code id=windows:dom-domimplementation-createdocument><a data-x-internal=dom-domimplementation-createdocument href=https://dom.spec.whatwg.org/#dom-domimplementation-createdocument>createDocument()</a></code>
  never has a <a href=#concept-document-bc id=windows:concept-document-bc-3>browsing context</a>. And the
  <code id=windows:document-12><a href=#document>Document</a></code> originally created for an <code id=windows:the-iframe-element-2><a href=#the-iframe-element>iframe</a></code> element, which has since been
  <a href=#remove-an-element-from-a-document id=windows:remove-an-element-from-a-document>removed from the document</a>, has no associated
  browsing context, since that browsing context was <a href=#a-browsing-context-is-discarded id=windows:a-browsing-context-is-discarded-2>discarded</a>.</p>

  <hr>

  <p>A <a href=#browsing-context id=windows:browsing-context-9>browsing context</a> can have a <dfn id=creator-browsing-context data-export="">creator browsing context</dfn>,
  the <a href=#browsing-context id=windows:browsing-context-10>browsing context</a> that was responsible for its creation. If a <a href=#browsing-context id=windows:browsing-context-11>browsing
  context</a> has a <a href=#parent-browsing-context id=windows:parent-browsing-context>parent browsing context</a>, then that is its <a href=#creator-browsing-context id=windows:creator-browsing-context>creator browsing
  context</a>. Otherwise, if the <a href=#browsing-context id=windows:browsing-context-12>browsing context</a> has an <a href=#opener-browsing-context id=windows:opener-browsing-context>opener browsing
  context</a>, then <em>that</em> is its <a href=#creator-browsing-context id=windows:creator-browsing-context-2>creator browsing context</a>. Otherwise, the
  <a href=#browsing-context id=windows:browsing-context-13>browsing context</a> has no <a href=#creator-browsing-context id=windows:creator-browsing-context-3>creator browsing context</a>.</p>

  <p>If a <a href=#browsing-context id=windows:browsing-context-14>browsing context</a> <var>context</var> has a <a href=#creator-browsing-context id=windows:creator-browsing-context-4>creator browsing
  context</a> <var>creator</var>, it also has the following properties. In what follows, let
  <var>creator document</var> be <var>creator</var>'s <a href=#active-document id=windows:active-document>active document</a> at the time
  <var>context</var> is created:</p>

  <dl><dt><dfn id=creator-origin>creator origin</dfn><dd><var>creator document</var>'s <a href=#concept-origin id=windows:concept-origin>origin</a><dt><dfn id=creator-url>creator URL</dfn><dd><var>creator document</var>'s <a href=https://dom.spec.whatwg.org/#concept-document-url id="windows:the-document's-address" data-x-internal="the-document's-address">URL</a><dt><dfn id=creator-base-url>creator base URL</dfn><dd><var>creator document</var>'s <a href=#document-base-url id=windows:document-base-url>base URL</a><dt><dfn id=creator-referrer-policy>creator referrer policy</dfn><dd><var>creator document</var>'s <a href=#concept-document-referrer-policy id=windows:concept-document-referrer-policy>referrer
   policy</a><dt><dfn id=creator-context-security>creator context security</dfn><dd>The result of executing <a id=windows:is-environment-settings-object-a-secure-context href=https://w3c.github.io/webappsec-secure-contexts/#settings-object data-x-internal=is-environment-settings-object-a-secure-context>Is environment settings object a secure context?</a> on
   <var>creator document</var>'s <a href=#relevant-settings-object id=windows:relevant-settings-object>relevant settings object</a></dl>

  

  <p>To <dfn id=creating-a-new-browsing-context>create a new browsing context</dfn>:</p>

  <ol><li><p>Let <var>browsingContext</var> be a new <a href=#browsing-context id=windows:browsing-context-15>browsing context</a>.<li>
    <p>Call the JavaScript <a href=https://tc39.github.io/ecma262/#sec-initializehostdefinedrealm id=windows:js-initializehostdefinedrealm data-x-internal=js-initializehostdefinedrealm>InitializeHostDefinedRealm()</a> abstract operation
    with the following customizations:</p>

    <ul><li><p>For the global object, create a new <code id=windows:window-4><a href=#window>Window</a></code> object
     <var>window</var>.<li><p>For the global <b>this</b> value, use <var>browsingContext</var>'s
     <code id=windows:windowproxy-2><a href=#windowproxy>WindowProxy</a></code> object.<li><p>Let <var>realm execution context</var> be the created <a id=windows:javascript-execution-context href=https://tc39.github.io/ecma262/#sec-execution-contexts data-x-internal=javascript-execution-context>JavaScript execution
     context</a>.</ul>
   <li><p><a href=#set-up-a-browsing-context-environment-settings-object id=windows:set-up-a-browsing-context-environment-settings-object>Set up a browsing context environment settings object</a> with <var>realm
   execution context</var>, and let <var>settingsObject</var> be the result.<li><p>Let <var>document</var> be a new <code id=windows:document-13><a href=#document>Document</a></code>, marked as an <a href=https://dom.spec.whatwg.org/#html-document id=windows:html-documents data-x-internal=html-documents>HTML document</a> in <a id=windows:quirks-mode href=https://dom.spec.whatwg.org/#concept-document-quirks data-x-internal=quirks-mode>quirks mode</a>, whose <a href=https://dom.spec.whatwg.org/#concept-document-content-type id=windows:concept-document-content-type data-x-internal=concept-document-content-type>content type</a> is "<code>text/html</code>",
   and which is both <a href=#ready-for-post-load-tasks id=windows:ready-for-post-load-tasks>ready for post-load tasks</a> and <a href=#completely-loaded id=windows:completely-loaded>completely loaded</a>
   immediately.<li><p>Ensure that <var>document</var> has a single child <code id=windows:the-html-element><a href=#the-html-element>html</a></code> node, which itself
   has two empty child nodes: a <code id=windows:the-head-element><a href=#the-head-element>head</a></code> element, and a <code id=windows:the-body-element><a href=#the-body-element>body</a></code> element.<li><p>Set <var>window</var>'s <a href=#concept-document-window id=windows:concept-document-window>associated
   <code>Document</code></a> to <var>document</var>.<li>
    <p>Set <var>browsingContext</var>'s <code id=windows:windowproxy-3><a href=#windowproxy>WindowProxy</a></code> object's
    <a href=#concept-windowproxy-window id=windows:concept-windowproxy-window>[[Window]]</a> internal slot
    value to <var>window</var>.</p>

    <p class=note>The internal slot value is updated when navigations occur.</p>
   <li>
    <p id=about-blank-origin>Set the <a href=#concept-origin id=windows:concept-origin-2>origin</a> of <var>document</var>:</p>

    <ul><li><p>If <var>browsingContext</var> has a <a href=#creator-browsing-context id=windows:creator-browsing-context-5>creator browsing context</a>, then the
     <a href=#concept-origin id=windows:concept-origin-3>origin</a> of <var>document</var> is the <a href=#creator-origin id=windows:creator-origin>creator origin</a>.<li><p>Otherwise, the <a href=#concept-origin id=windows:concept-origin-4>origin</a> of <var>document</var> is a unique <a href=#concept-origin-opaque id=windows:concept-origin-opaque>opaque origin</a>.</ul>
   <li><p>If <var>browsingContext</var> has a <a href=#creator-browsing-context id=windows:creator-browsing-context-6>creator browsing context</a>, then set
   <var>document</var>'s <a href="#the-document's-referrer" id="windows:the-document's-referrer">referrer</a> to the <a href=https://url.spec.whatwg.org/#concept-url-serializer id=windows:concept-url-serializer data-x-internal=concept-url-serializer>serialization</a> of <a href=#creator-url id=windows:creator-url>creator URL</a>.<li><p>If <var>browsingContext</var> has a <a href=#creator-browsing-context id=windows:creator-browsing-context-7>creator browsing context</a>, then set
   <var>document</var>'s <a href=#concept-document-referrer-policy id=windows:concept-document-referrer-policy-2>referrer policy</a> to
   the <a href=#creator-referrer-policy id=windows:creator-referrer-policy>creator referrer policy</a>.<li><p><a href=#implement-the-sandboxing id=windows:implement-the-sandboxing>Implement the sandboxing</a> for <var>document</var>.<li><p><a href=#set-the-allow*-flags id=windows:set-the-allow*-flags>Set the allow* flags</a> for <var>document</var>.<li><p>Set <var>settingsObject</var>'s <a href=#concept-environment-execution-ready-flag id=windows:concept-environment-execution-ready-flag>execution ready flag</a>.<li><p>Add <var>document</var> to <var>browsingContext</var>'s <a href=#session-history id=windows:session-history-3>session
   history</a>.<li><p>Return <var>browsingContext</var>.</ol>

  


  <h4 id=nested-browsing-contexts>7.1.1 Nested browsing contexts<a href=#nested-browsing-contexts class=self-link></a></h4>

  <p>Certain elements (for example, <code id=nested-browsing-contexts:the-iframe-element><a href=#the-iframe-element>iframe</a></code> elements) can instantiate further <a href=#browsing-context id=nested-browsing-contexts:browsing-context>browsing contexts</a>. These elements are called <dfn id=browsing-context-container data-lt="browsing context container" data-export="">browsing
  context containers</dfn>.</p>

  <p>Each <a href=#browsing-context-container id=nested-browsing-contexts:browsing-context-container>browsing context container</a> has a <dfn id=nested-browsing-context data-export="">nested browsing
  context</dfn>, which is either a <a href=#browsing-context id=nested-browsing-contexts:browsing-context-2>browsing context</a> or null.</p>

  <p>If a <a href=#browsing-context id=nested-browsing-contexts:browsing-context-3>browsing context</a> is the <a href=#nested-browsing-context id=nested-browsing-contexts:nested-browsing-context>nested browsing context</a> of a
  <a href=#browsing-context-container id=nested-browsing-contexts:browsing-context-container-2>browsing context container</a>, then the browsing context is said to be <dfn id=browsing-context-nested-through data-export="">nested through</dfn> the <a href=#browsing-context-container id=nested-browsing-contexts:browsing-context-container-3>browsing
  context container</a>'s <a id=nested-browsing-contexts:node-document href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node document</a>.</p>

  <p>A <a href=#browsing-context id=nested-browsing-contexts:browsing-context-4>browsing context</a> <var>child</var> is said to be a <dfn id=child-browsing-context data-export="">child
  browsing context</dfn> of another <a href=#browsing-context id=nested-browsing-contexts:browsing-context-5>browsing context</a> <var>parent</var>, if all of the
  following conditions hold:</p>

  <ul><li><p><var>child</var> is a <a href=#nested-browsing-context id=nested-browsing-contexts:nested-browsing-context-2>nested browsing context</a> of a <a href=#browsing-context-container id=nested-browsing-contexts:browsing-context-container-4>browsing context
   container</a> <var>element</var><li><p><var>element</var> is <a id=nested-browsing-contexts:connected href=https://dom.spec.whatwg.org/#connected data-x-internal=connected>connected</a><li><p><var>element</var>'s <a id=nested-browsing-contexts:shadow-including-root href=https://dom.spec.whatwg.org/#concept-shadow-including-root data-x-internal=shadow-including-root>shadow-including root</a>'s <a href=#concept-document-bc id=nested-browsing-contexts:concept-document-bc>browsing context</a> is <var>parent</var></ul>

  <p>A <a href=#browsing-context id=nested-browsing-contexts:browsing-context-6>browsing context</a> <var>child</var> is then a <dfn id=document-tree-child-browsing-context>document-tree child browsing
  context</dfn> of <var>parent</var> if it is a <a href=#child-browsing-context id=nested-browsing-contexts:child-browsing-context>child browsing context</a> and its
  <a href=#browsing-context-container id=nested-browsing-contexts:browsing-context-container-5>browsing context container</a> is not just <a id=nested-browsing-contexts:connected-2 href=https://dom.spec.whatwg.org/#connected data-x-internal=connected>connected</a>, but also <a id=nested-browsing-contexts:in-a-document-tree href=https://dom.spec.whatwg.org/#in-a-document-tree data-x-internal=in-a-document-tree>in a
  document tree</a>.</p>

  <p>A <a href=#browsing-context id=nested-browsing-contexts:browsing-context-7>browsing context</a> <var>child</var> may have a <dfn id=parent-browsing-context data-export="">parent browsing
  context</dfn>. This is the unique <a href=#browsing-context id=nested-browsing-contexts:browsing-context-8>browsing context</a> that has <var>child</var> as a
  <a href=#child-browsing-context id=nested-browsing-contexts:child-browsing-context-2>child browsing context</a>, if any such browsing context exists. Otherwise, the
  <a href=#browsing-context id=nested-browsing-contexts:browsing-context-9>browsing context</a> has no <a href=#parent-browsing-context id=nested-browsing-contexts:parent-browsing-context>parent browsing context</a>.</p>

  <p>A <a href=#browsing-context id=nested-browsing-contexts:browsing-context-10>browsing context</a> <var>A</var> is said to be an <dfn id=ancestor-browsing-context data-lt="ancestor browsing context" data-export="">ancestor</dfn> of a browsing context
  <var>B</var> if there exists a browsing context <var>A'</var> that is a <a href=#child-browsing-context id=nested-browsing-contexts:child-browsing-context-3>child browsing
  context</a> of <var>A</var> and that is itself an <a href=#ancestor-browsing-context id=nested-browsing-contexts:ancestor-browsing-context>ancestor</a> of <var>B</var>, or if the browsing context <var>A</var> is the
  <a href=#parent-browsing-context id=nested-browsing-contexts:parent-browsing-context-2>parent browsing context</a> of <var>B</var>.</p>

  <p>A <a href=#browsing-context id=nested-browsing-contexts:browsing-context-11>browsing context</a> that is not a <a href=#nested-browsing-context id=nested-browsing-contexts:nested-browsing-context-3>nested browsing context</a> has no
  <a href=#parent-browsing-context id=nested-browsing-contexts:parent-browsing-context-3>parent browsing context</a>, and is the <dfn id=top-level-browsing-context data-export="">top-level browsing
  context</dfn> of all the browsing contexts for which it is an <a href=#ancestor-browsing-context id=nested-browsing-contexts:ancestor-browsing-context-2>ancestor browsing
  context</a>.</p>

  <p>The transitive closure of <a href=#parent-browsing-context id=nested-browsing-contexts:parent-browsing-context-4>parent browsing contexts</a>
  for a <a href=#browsing-context id=nested-browsing-contexts:browsing-context-12>browsing context</a> that is a <a href=#nested-browsing-context id=nested-browsing-contexts:nested-browsing-context-4>nested browsing context</a> gives the list
  of <a href=#ancestor-browsing-context id=nested-browsing-contexts:ancestor-browsing-context-3>ancestor browsing contexts</a>.</p>

  <p>The <dfn id=list-of-the-descendant-browsing-contexts>list of the descendant browsing contexts</dfn> of a <code id=nested-browsing-contexts:document><a href=#document>Document</a></code> <var>d</var>
  is the (ordered) list returned by the following algorithm:</p>

  <ol><li><p>Let <var>list</var> be an empty list.<li>

    <p>For each <a href=#child-browsing-context id=nested-browsing-contexts:child-browsing-context-4>child browsing context</a> of <var>d</var> that is <a href=#browsing-context-nested-through id=nested-browsing-contexts:browsing-context-nested-through>nested through</a> an element that is <a href=https://dom.spec.whatwg.org/#in-a-document id=nested-browsing-contexts:in-a-document data-x-internal=in-a-document>in
    the <code>Document</code></a> <var>d</var>, in the <a id=nested-browsing-contexts:tree-order href=https://dom.spec.whatwg.org/#concept-tree-order data-x-internal=tree-order>tree order</a> of the elements
    nesting those <a href=#browsing-context id=nested-browsing-contexts:browsing-context-13>browsing contexts</a>, run these substeps:</p>

    <ol><li><p>Append that <a href=#child-browsing-context id=nested-browsing-contexts:child-browsing-context-5>child browsing context</a> to the list <var>list</var>.</p>

     <li><p>Append the <a href=#list-of-the-descendant-browsing-contexts id=nested-browsing-contexts:list-of-the-descendant-browsing-contexts>list of the descendant browsing contexts</a> of the <a href=#active-document id=nested-browsing-contexts:active-document>active
     document</a> of that <a href=#child-browsing-context id=nested-browsing-contexts:child-browsing-context-6>child browsing context</a> to the list <var>list</var>.</ol>

   <li><p>Return the constructed <var>list</var>.</ol>

  <p>A <code id=nested-browsing-contexts:document-2><a href=#document>Document</a></code> is said to be <dfn data-dfn-for=Document id=fully-active data-export="">fully
  active</dfn> when it has a <a href=#concept-document-bc id=nested-browsing-contexts:concept-document-bc-2>browsing context</a> and it is
  the <a href=#active-document id=nested-browsing-contexts:active-document-2>active document</a> of that <a href=#browsing-context id=nested-browsing-contexts:browsing-context-14>browsing context</a>, and either its browsing
  context is a <a href=#top-level-browsing-context id=nested-browsing-contexts:top-level-browsing-context>top-level browsing context</a>, or it has a <a href=#parent-browsing-context id=nested-browsing-contexts:parent-browsing-context-5>parent browsing
  context</a> and the <code id=nested-browsing-contexts:document-3><a href=#document>Document</a></code> <a href=#browsing-context-nested-through id=nested-browsing-contexts:browsing-context-nested-through-2>through which</a> it is <a href=#nested-browsing-context id=nested-browsing-contexts:nested-browsing-context-5>nested</a> is itself
  <a href=#fully-active id=nested-browsing-contexts:fully-active>fully active</a>.</p>

  <p>Because they are associated with an element, <a href=#child-browsing-context id=nested-browsing-contexts:child-browsing-context-7>child
  browsing contexts</a> are always tied to a specific <code id=nested-browsing-contexts:document-4><a href=#document>Document</a></code> in their <a href=#parent-browsing-context id=nested-browsing-contexts:parent-browsing-context-6>parent
  browsing context</a>. User agents must not allow the user to interact with <a href=#child-browsing-context id=nested-browsing-contexts:child-browsing-context-8>child browsing contexts</a> of elements that are in <code id=nested-browsing-contexts:document-5><a href=#document>Document</a></code>s
  that are not themselves <a href=#fully-active id=nested-browsing-contexts:fully-active-2>fully active</a>.</p>

  <p>A <a href=#browsing-context id=nested-browsing-contexts:browsing-context-15>browsing context</a> that is a <a href=#nested-browsing-context id=nested-browsing-contexts:nested-browsing-context-6>nested browsing context</a> can be put into
  a <dfn id=delaying-load-events-mode>delaying <code>load</code> events mode</dfn>. This is used when it is
  <a href=#navigate id=nested-browsing-contexts:navigate>navigated</a>, to <a href=#delay-the-load-event id=nested-browsing-contexts:delay-the-load-event>delay the load event</a> of its
  <a href=#browsing-context-container id=nested-browsing-contexts:browsing-context-container-6>browsing context container</a> before the new <code id=nested-browsing-contexts:document-6><a href=#document>Document</a></code> is created.</p>



  <p>The <dfn id=document-family>document family</dfn> of a <a href=#browsing-context id=nested-browsing-contexts:browsing-context-16>browsing context</a> consists of the union of all
  the <code id=nested-browsing-contexts:document-7><a href=#document>Document</a></code> objects in that <a href=#browsing-context id=nested-browsing-contexts:browsing-context-17>browsing context</a>'s <a href=#session-history id=nested-browsing-contexts:session-history>session
  history</a> and the <a href=#document-family id=nested-browsing-contexts:document-family>document families</a> of all those
  <code id=nested-browsing-contexts:document-8><a href=#document>Document</a></code> objects. The <a href=#document-family id=nested-browsing-contexts:document-family-2>document family</a> of a <code id=nested-browsing-contexts:document-9><a href=#document>Document</a></code> object
  consists of the union of all the <a href=#document-family id=nested-browsing-contexts:document-family-3>document families</a> of the
  <a href=#browsing-context id=nested-browsing-contexts:browsing-context-18>browsing contexts</a> that are <a href=#browsing-context-nested-through id=nested-browsing-contexts:browsing-context-nested-through-3>nested through</a> the <code id=nested-browsing-contexts:document-10><a href=#document>Document</a></code> object.</p>

  <p>The <dfn id=concept-bcc-content-document>content document</dfn> of a <a href=#browsing-context-container id=nested-browsing-contexts:browsing-context-container-7>browsing
  context container</a> <var>container</var> is the result of the following algorithm:</p>

  <ol><li><p>If <var>container</var>'s <a href=#nested-browsing-context id=nested-browsing-contexts:nested-browsing-context-7>nested browsing context</a> is null, then return
   null.<li><p>Let <var>context</var> be <var>container</var>'s <a href=#nested-browsing-context id=nested-browsing-contexts:nested-browsing-context-8>nested browsing
   context</a>.<li><p>Let <var>document</var> be <var>context</var>'s <a href=#active-document id=nested-browsing-contexts:active-document-3>active document</a>.<li><p>If <var>document</var>'s <a href=#concept-origin id=nested-browsing-contexts:concept-origin>origin</a> and the <a href=#concept-settings-object-origin id=nested-browsing-contexts:concept-settings-object-origin>origin</a> specified by the <a href=#current-settings-object id=nested-browsing-contexts:current-settings-object>current settings
   object</a> are not <a href=#same-origin-domain id=nested-browsing-contexts:same-origin-domain>same origin-domain</a>, then return null.<li><p>Return <var>document</var>.</ol>


  <h5 id=navigating-nested-browsing-contexts-in-the-dom>7.1.1.1 Navigating nested browsing contexts in the DOM<a href=#navigating-nested-browsing-contexts-in-the-dom class=self-link></a></h5>

  <dl class=domintro><dt><var>window</var> . <code id=navigating-nested-browsing-contexts-in-the-dom:dom-top><a href=#dom-top>top</a></code><dd>

    <p>Returns the <code id=navigating-nested-browsing-contexts-in-the-dom:windowproxy><a href=#windowproxy>WindowProxy</a></code> for the <a href=#top-level-browsing-context id=navigating-nested-browsing-contexts-in-the-dom:top-level-browsing-context>top-level browsing context</a>.</p>

   <dt><var>window</var> . <code id=navigating-nested-browsing-contexts-in-the-dom:dom-parent><a href=#dom-parent>parent</a></code><dd>

    <p>Returns the <code id=navigating-nested-browsing-contexts-in-the-dom:windowproxy-2><a href=#windowproxy>WindowProxy</a></code> for the <a href=#parent-browsing-context id=navigating-nested-browsing-contexts-in-the-dom:parent-browsing-context>parent browsing context</a>.</p>

   <dt><var>window</var> . <code id=navigating-nested-browsing-contexts-in-the-dom:dom-frameelement><a href=#dom-frameelement>frameElement</a></code><dd>

    <p>Returns the <code id=navigating-nested-browsing-contexts-in-the-dom:element><a data-x-internal=element href=https://dom.spec.whatwg.org/#interface-element>Element</a></code> for the <a href=#browsing-context-container id=navigating-nested-browsing-contexts-in-the-dom:browsing-context-container>browsing context container</a>.</p>

    <p>Returns null if there isn't one, and in cross-origin situations.</p>

   </dl>

  

  <p>The <dfn id=dom-top><code>top</code></dfn> IDL attribute, on getting, must run the
  following algorithm:</p>

  <ol><li><p>Let <var>windowProxy</var> be this <code id=navigating-nested-browsing-contexts-in-the-dom:window><a href=#window>Window</a></code> object's <code id=navigating-nested-browsing-contexts-in-the-dom:windowproxy-3><a href=#windowproxy>WindowProxy</a></code>
   object.<li><p>If there is no <a href=#browsing-context id=navigating-nested-browsing-contexts-in-the-dom:browsing-context>browsing context</a> with <var>windowProxy</var> as its
   <code id=navigating-nested-browsing-contexts-in-the-dom:windowproxy-4><a href=#windowproxy>WindowProxy</a></code> object, then return null.</p>

   <li><p>Let <var>context</var> be that <a href=#browsing-context id=navigating-nested-browsing-contexts-in-the-dom:browsing-context-2>browsing context</a>.<li><p>If <var>context</var> is a <a href=#top-level-browsing-context id=navigating-nested-browsing-contexts-in-the-dom:top-level-browsing-context-2>top-level browsing context</a>, then return
   <var>context</var>'s <code id=navigating-nested-browsing-contexts-in-the-dom:windowproxy-5><a href=#windowproxy>WindowProxy</a></code> object.<li><p>Otherwise, <var>context</var> must have a <a href=#top-level-browsing-context id=navigating-nested-browsing-contexts-in-the-dom:top-level-browsing-context-3>top-level browsing context</a> (i.e. an
   <a href=#ancestor-browsing-context id=navigating-nested-browsing-contexts-in-the-dom:ancestor-browsing-context>ancestor browsing context</a> with no <a href=#parent-browsing-context id=navigating-nested-browsing-contexts-in-the-dom:parent-browsing-context-2>parent browsing context</a>). Return that
   <a href=#top-level-browsing-context id=navigating-nested-browsing-contexts-in-the-dom:top-level-browsing-context-4>top-level browsing context</a>'s <code id=navigating-nested-browsing-contexts-in-the-dom:windowproxy-6><a href=#windowproxy>WindowProxy</a></code> object.</ol>

  <p>The <dfn id=dom-parent><code>parent</code></dfn> IDL attribute, on getting, must run the
  following algorithm:</p>

  <ol><li><p>Let <var>windowProxy</var> be this <code id=navigating-nested-browsing-contexts-in-the-dom:window-2><a href=#window>Window</a></code> object's <code id=navigating-nested-browsing-contexts-in-the-dom:windowproxy-7><a href=#windowproxy>WindowProxy</a></code>
   object.<li><p>If there is no <a href=#browsing-context id=navigating-nested-browsing-contexts-in-the-dom:browsing-context-3>browsing context</a> with <var>windowProxy</var> as its
   <code id=navigating-nested-browsing-contexts-in-the-dom:windowproxy-8><a href=#windowproxy>WindowProxy</a></code> object, then return null.</p>

   <li><p>Let <var>context</var> be that <a href=#browsing-context id=navigating-nested-browsing-contexts-in-the-dom:browsing-context-4>browsing context</a>.<li><p>If <var>context</var> is a <a href=#child-browsing-context id=navigating-nested-browsing-contexts-in-the-dom:child-browsing-context>child browsing context</a> of another <a href=#browsing-context id=navigating-nested-browsing-contexts-in-the-dom:browsing-context-5>browsing
   context</a> <var>parent</var>, then return <var>parent</var>'s <code id=navigating-nested-browsing-contexts-in-the-dom:windowproxy-9><a href=#windowproxy>WindowProxy</a></code>
   object.<li><p>Otherwise, <var>context</var> must be a <a href=#top-level-browsing-context id=navigating-nested-browsing-contexts-in-the-dom:top-level-browsing-context-5>top-level browsing context</a>. Return
   <var>context</var>'s <code id=navigating-nested-browsing-contexts-in-the-dom:windowproxy-10><a href=#windowproxy>WindowProxy</a></code> object.</ol>

  <p>The <dfn id=dom-frameelement><code>frameElement</code></dfn> IDL attribute, on getting,
  must run the following algorithm:</p>

  <ol><li><p>Let <var>windowProxy</var> be this <code id=navigating-nested-browsing-contexts-in-the-dom:window-3><a href=#window>Window</a></code> object's <code id=navigating-nested-browsing-contexts-in-the-dom:windowproxy-11><a href=#windowproxy>WindowProxy</a></code>
   object.<li><p>If there is no <a href=#browsing-context id=navigating-nested-browsing-contexts-in-the-dom:browsing-context-6>browsing context</a> with <var>windowProxy</var> as its
   <code id=navigating-nested-browsing-contexts-in-the-dom:windowproxy-12><a href=#windowproxy>WindowProxy</a></code> object, then return null.</p>

   <li><p>Let <var>context</var> be that <a href=#browsing-context id=navigating-nested-browsing-contexts-in-the-dom:browsing-context-7>browsing context</a>.<li><p>If <var>context</var> is not a <a href=#nested-browsing-context id=navigating-nested-browsing-contexts-in-the-dom:nested-browsing-context>nested browsing context</a>, then return
   null.<li><p>Let <var>container</var> be <var>context</var>'s <a href=#browsing-context-container id=navigating-nested-browsing-contexts-in-the-dom:browsing-context-container-2>browsing context
   container</a>.<li><p>If <var>container</var>'s <a id=navigating-nested-browsing-contexts-in-the-dom:node-document href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node document</a>'s <a href=#concept-origin id=navigating-nested-browsing-contexts-in-the-dom:concept-origin>origin</a> is not
   <a href=#same-origin-domain id=navigating-nested-browsing-contexts-in-the-dom:same-origin-domain>same origin-domain</a> with the <a href=#current-settings-object id=navigating-nested-browsing-contexts-in-the-dom:current-settings-object>current settings object</a>'s <a href=#concept-settings-object-origin id=navigating-nested-browsing-contexts-in-the-dom:concept-settings-object-origin>origin</a>, then return null.<li><p>Return <var>container</var>.</ol>

  <div class=example>
   <p>An example of when these IDL attributes can return null is as follows:</p>

   <pre>&lt;!DOCTYPE html>
&lt;iframe>&lt;/iframe>

&lt;script>
"use strict";
const element = document.querySelector("iframe");
const iframeWindow = element.contentWindow;
element.remove();

console.assert(iframeWindow.top === null);
console.assert(iframeWindow.parent === null);
console.assert(iframeWindow.frameElement === null);
&lt;/script></pre>

   <p>Here the <a href=#browsing-context id=navigating-nested-browsing-contexts-in-the-dom:browsing-context-8>browsing context</a> corresponding to <code>iframeWindow</code>
   was <a href=#a-browsing-context-is-discarded id=navigating-nested-browsing-contexts-in-the-dom:a-browsing-context-is-discarded>discarded</a> when <code>element</code> was removed from the document.</p>
  </div>

  



  <h4 id=auxiliary-browsing-contexts>7.1.2 Auxiliary browsing contexts<a href=#auxiliary-browsing-contexts class=self-link></a></h4>

  <p>It is possible to create new browsing contexts that are related to a <a href=#top-level-browsing-context id=auxiliary-browsing-contexts:top-level-browsing-context>top-level browsing
  context</a> without being nested through an element. Such browsing contexts are called <dfn id=auxiliary-browsing-context data-lt="auxiliary browsing context" data-export="">auxiliary
  browsing contexts</dfn>. Auxiliary browsing contexts are always <a href=#top-level-browsing-context id=auxiliary-browsing-contexts:top-level-browsing-context-2 data-lt="top-level browsing context" data-export="">top-level browsing
  contexts</a>.</p>

  <p>An <a href=#auxiliary-browsing-context id=auxiliary-browsing-contexts:auxiliary-browsing-context>auxiliary browsing context</a> has an <dfn id=opener-browsing-context data-export="">opener browsing
  context</dfn>, which is the <a href=#browsing-context id=auxiliary-browsing-contexts:browsing-context>browsing context</a> from which the <a href=#auxiliary-browsing-context id=auxiliary-browsing-contexts:auxiliary-browsing-context-2>auxiliary browsing
  context</a> was created.</p>


  <h5 id=navigating-auxiliary-browsing-contexts-in-the-dom>7.1.2.1 Navigating auxiliary browsing contexts in the DOM<a href=#navigating-auxiliary-browsing-contexts-in-the-dom class=self-link></a></h5>

  <p>The <dfn id=dom-opener><code>opener</code></dfn> IDL attribute on the <code id=navigating-auxiliary-browsing-contexts-in-the-dom:window><a href=#window>Window</a></code>
  object, on getting, must return the <code id=navigating-auxiliary-browsing-contexts-in-the-dom:windowproxy><a href=#windowproxy>WindowProxy</a></code> object of the <a href=#browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context>browsing
  context</a> from which the current <a href=#browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context-2>browsing context</a> was created (its <a href=#opener-browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:opener-browsing-context>opener
  browsing context</a>), if there is one, if it is still available, and if the current
  <a href=#browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context-3>browsing context</a> has not <i id=navigating-auxiliary-browsing-contexts-in-the-dom:disowned-its-opener><a href=#disowned-its-opener>disowned its opener</a></i>;
  otherwise, it must return null. On setting, if the new value is null then the current
  <a href=#browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context-4>browsing context</a> must <dfn id=disowned-its-opener data-export="">disown its
  opener</dfn>; if the new value is anything else then the user agent must

    
    call the [[DefineOwnProperty]] internal method of the <code id=navigating-auxiliary-browsing-contexts-in-the-dom:window-2><a href=#window>Window</a></code> object, passing the
    property name "<code>opener</code>" as the property key, and the Property Descriptor {
    [[Value]]: <var>value</var>, [[Writable]]: true, [[Enumerable]]: true,
    [[Configurable]]: true } as the property descriptor,
    

  where <var>value</var> is the new value.</p>

 <div class=note>
  <p>If a <a href=#browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context-5>browsing context</a> has <a href=#disowned-its-opener id=navigating-auxiliary-browsing-contexts-in-the-dom:disowned-its-opener-2>disowned its
  opener</a>, the value of its <code id=navigating-auxiliary-browsing-contexts-in-the-dom:dom-opener><a href=#dom-opener>window.opener</a></code> is <code>null</code>. That prevents scripts in the <a href=#browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context-6>browsing context</a> from changing
  any properties of its <a href=#opener-browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:opener-browsing-context-2>opener browsing context</a>'s <code id=navigating-auxiliary-browsing-contexts-in-the-dom:window-3><a href=#window>Window</a></code> (i.e., the window
  from which the <a href=#browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context-7>browsing context</a> was created).</p>

  <p>Otherwise, if a <a href=#browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context-8>browsing context</a> has <em>not</em> <a href=#disowned-its-opener id=navigating-auxiliary-browsing-contexts-in-the-dom:disowned-its-opener-3>disowned its
  opener</a>, then scripts in that <a href=#browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context-9>browsing context</a> can use <code id=navigating-auxiliary-browsing-contexts-in-the-dom:dom-opener-2><a href=#dom-opener>window.opener</a></code> to change properties of its <a href=#opener-browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:opener-browsing-context-3>opener browsing
  context</a>'s <code id=navigating-auxiliary-browsing-contexts-in-the-dom:window-4><a href=#window>Window</a></code>. For example, a script running in the <a href=#browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:browsing-context-10>browsing
  context</a> can change the value of <code>window.opener.location</code>, causing the
  <a href=#opener-browsing-context id=navigating-auxiliary-browsing-contexts-in-the-dom:opener-browsing-context-4>opener browsing context</a> to navigate to a completely different document.</p>
 </div>



  

  <h4 id=security-nav>7.1.3 Security<a href=#security-nav class=self-link></a></h4>

  <p id=security-1>A <a href=#browsing-context id=security-nav:browsing-context>browsing context</a> <var>A</var> is <dfn id=familiar-with>familiar
  with</dfn> a second <a href=#browsing-context id=security-nav:browsing-context-2>browsing context</a> <var>B</var> if one of the following
  conditions is true:</p>

  <ul><li>Either the <a href=#concept-origin id=security-nav:concept-origin>origin</a> of the <a href=#active-document id=security-nav:active-document>active document</a> of <var>A</var>
   is the <a href=#same-origin id=security-nav:same-origin>same</a> as the <a href=#concept-origin id=security-nav:concept-origin-2>origin</a> of the <a href=#active-document id=security-nav:active-document-2>active
   document</a> of <var>B</var>, or<li>The browsing context <var>A</var> is a <a href=#nested-browsing-context id=security-nav:nested-browsing-context>nested browsing context</a> with a
   <a href=#top-level-browsing-context id=security-nav:top-level-browsing-context>top-level browsing context</a>, and its <a href=#top-level-browsing-context id=security-nav:top-level-browsing-context-2>top-level browsing context</a> is <var>B</var>, or<li>The browsing context <var>B</var> is an <a href=#auxiliary-browsing-context id=security-nav:auxiliary-browsing-context>auxiliary browsing context</a> and
   <var>A</var> is <a href=#familiar-with id=security-nav:familiar-with>familiar with</a> <var>B</var>'s <a href=#opener-browsing-context id=security-nav:opener-browsing-context>opener
   browsing context</a>, or<li>The browsing context <var>B</var> is not a <a href=#top-level-browsing-context id=security-nav:top-level-browsing-context-3>top-level browsing context</a>,
   but there exists an <a href=#ancestor-browsing-context id=security-nav:ancestor-browsing-context>ancestor browsing context</a> of <var>B</var> whose
   <a href=#active-document id=security-nav:active-document-3>active document</a> has the <a href=#same-origin id=security-nav:same-origin-2>same</a> <a href=#concept-origin id=security-nav:concept-origin-3>origin</a> as
   the <a href=#active-document id=security-nav:active-document-4>active document</a> of <var>A</var> (possibly in fact being <var>A</var> itself).</ul>

  <hr>

  <p>A <a href=#browsing-context id=security-nav:browsing-context-3>browsing context</a> <var>A</var> is <dfn id=allowed-to-navigate>allowed to navigate</dfn> a
  second <a href=#browsing-context id=security-nav:browsing-context-4>browsing context</a> <var>B</var> if the following algorithm terminates
  positively:</p>

  <ol><li><p>If <var>A</var> is not the same <a href=#browsing-context id=security-nav:browsing-context-5>browsing context</a> as <var>B</var>, and <var>A</var> is not one of the <a href=#ancestor-browsing-context id=security-nav:ancestor-browsing-context-2>ancestor browsing contexts</a> of <var>B</var>, and <var>B</var>
   is not a <a href=#top-level-browsing-context id=security-nav:top-level-browsing-context-4>top-level browsing context</a>, and <var>A</var>'s <a href=#active-document id=security-nav:active-document-5>active
   document</a>'s <a href=#active-sandboxing-flag-set id=security-nav:active-sandboxing-flag-set>active sandboxing flag set</a> has its <a href=#sandboxed-navigation-browsing-context-flag id=security-nav:sandboxed-navigation-browsing-context-flag>sandboxed navigation
   browsing context flag</a> set, then abort these steps negatively.<li><p>Otherwise, if <var>B</var> is a <a href=#top-level-browsing-context id=security-nav:top-level-browsing-context-5>top-level browsing context</a>, and is one of the
   <a href=#ancestor-browsing-context id=security-nav:ancestor-browsing-context-3>ancestor browsing contexts</a> of <var>A</var>, and
   <var>A</var>'s <a href=#active-document id=security-nav:active-document-6>active document</a>'s <a href=#active-sandboxing-flag-set id=security-nav:active-sandboxing-flag-set-2>active sandboxing flag set</a> has its
   <a href=#sandboxed-top-level-navigation-browsing-context-flag id=security-nav:sandboxed-top-level-navigation-browsing-context-flag>sandboxed top-level navigation browsing context flag</a> set, then abort these steps
   negatively.<li><p>Otherwise, if <var>B</var> is a <a href=#top-level-browsing-context id=security-nav:top-level-browsing-context-6>top-level browsing context</a>, and is
   neither <var>A</var> nor one of the <a href=#ancestor-browsing-context id=security-nav:ancestor-browsing-context-4>ancestor
   browsing contexts</a> of <var>A</var>, and <var>A</var>'s
   <code id=security-nav:document><a href=#document>Document</a></code>'s <a href=#active-sandboxing-flag-set id=security-nav:active-sandboxing-flag-set-3>active sandboxing flag set</a> has its <a href=#sandboxed-navigation-browsing-context-flag id=security-nav:sandboxed-navigation-browsing-context-flag-2>sandboxed
   navigation browsing context flag</a> set, and <var>A</var> is not the <a href=#one-permitted-sandboxed-navigator id=security-nav:one-permitted-sandboxed-navigator>one
   permitted sandboxed navigator</a> of <var>B</var>, then abort these steps
   negatively.<li><p>Otherwise, terminate positively!</ol>

  <hr>

  <p>An element has a <dfn id=browsing-context-scope-origin>browsing context scope origin</dfn> if its <code id=security-nav:document-2><a href=#document>Document</a></code>'s
  <a href=#concept-document-bc id=security-nav:concept-document-bc>browsing context</a> is a <a href=#top-level-browsing-context id=security-nav:top-level-browsing-context-7>top-level browsing
  context</a> or if all of its <code id=security-nav:document-3><a href=#document>Document</a></code>'s <a href=#ancestor-browsing-context id=security-nav:ancestor-browsing-context-5>ancestor browsing contexts</a> all have <a href=#active-document id=security-nav:active-document-7>active
  documents</a> whose <a href=#concept-origin id=security-nav:concept-origin-4>origin</a> are the <a href=#same-origin id=security-nav:same-origin-3>same origin</a> as the element's
  <a id=security-nav:node-document href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node document</a>'s <a href=#concept-origin id=security-nav:concept-origin-5>origin</a>. If an element has a <a href=#browsing-context-scope-origin id=security-nav:browsing-context-scope-origin>browsing context scope
  origin</a>, then its value is the <a href=#concept-origin id=security-nav:concept-origin-6>origin</a> of the element's <a id=security-nav:node-document-2 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node
  document</a>.</p>

  



  

  <h4 id=groupings-of-browsing-contexts>7.1.4 Groupings of browsing contexts<a href=#groupings-of-browsing-contexts class=self-link></a></h4>

  <p>Each <a href=#browsing-context id=groupings-of-browsing-contexts:browsing-context>browsing context</a> is defined as having a list of one or more <dfn id=directly-reachable-browsing-contexts>directly
  reachable browsing contexts</dfn>. These are:</p>

  <ul><li>The <a href=#browsing-context id=groupings-of-browsing-contexts:browsing-context-2>browsing context</a> itself.<li>All the <a href=#browsing-context id=groupings-of-browsing-contexts:browsing-context-3>browsing context</a>'s <a href=#child-browsing-context id=groupings-of-browsing-contexts:child-browsing-context>child browsing
   contexts</a>.<li>The <a href=#browsing-context id=groupings-of-browsing-contexts:browsing-context-4>browsing context</a>'s <a href=#parent-browsing-context id=groupings-of-browsing-contexts:parent-browsing-context>parent browsing context</a>.<li>All the <a href=#browsing-context id=groupings-of-browsing-contexts:browsing-context-5>browsing contexts</a> that have the <a href=#browsing-context id=groupings-of-browsing-contexts:browsing-context-6>browsing
   context</a> as their <a href=#opener-browsing-context id=groupings-of-browsing-contexts:opener-browsing-context>opener browsing context</a>.<li>The <a href=#browsing-context id=groupings-of-browsing-contexts:browsing-context-7>browsing context</a>'s <a href=#opener-browsing-context id=groupings-of-browsing-contexts:opener-browsing-context-2>opener browsing context</a>.</ul>

  <p>The transitive closure of all the <a href=#browsing-context id=groupings-of-browsing-contexts:browsing-context-8>browsing contexts</a> that
  are <a href=#directly-reachable-browsing-contexts id=groupings-of-browsing-contexts:directly-reachable-browsing-contexts>directly reachable browsing contexts</a> forms a <dfn id=unit-of-related-browsing-contexts>unit of related browsing
  contexts</dfn>.</p>

  <p>Each <a href=#unit-of-related-browsing-contexts id=groupings-of-browsing-contexts:unit-of-related-browsing-contexts>unit of related browsing contexts</a> is then further divided into the smallest
  number of groups such that every member of each group has an <a href=#active-document id=groupings-of-browsing-contexts:active-document>active document</a> with an
  <a href=#concept-origin id=groupings-of-browsing-contexts:concept-origin>origin</a> that, through appropriate manipulation of the <code id=groupings-of-browsing-contexts:dom-document-domain><a href=#dom-document-domain>document.domain</a></code> attribute, could be made to be <a href=#same-origin-domain id=groupings-of-browsing-contexts:same-origin-domain>same
  origin-domain</a> with other members of the group, but could not be made the same as members of
  any other group. Each such group is a <dfn id=unit-of-related-similar-origin-browsing-contexts data-export="">unit of related similar-origin browsing
  contexts</dfn>.</p>

  <p class=note>There is also at most one <a href=#event-loop id=groupings-of-browsing-contexts:event-loop>event loop</a> per <a href=#unit-of-related-similar-origin-browsing-contexts id=groupings-of-browsing-contexts:unit-of-related-similar-origin-browsing-contexts>unit of related
  similar-origin browsing contexts</a> (though several <a href=#unit-of-related-similar-origin-browsing-contexts id=groupings-of-browsing-contexts:unit-of-related-similar-origin-browsing-contexts-2>units of related similar-origin browsing contexts</a> can
  have a shared <a href=#event-loop id=groupings-of-browsing-contexts:event-loop-2>event loop</a>).</p>

  

