   <li>

    <p>If <var>objects</var> contains a <a href=#nested-browsing-context id=named-access-on-the-window-object:nested-browsing-context>nested browsing context</a>, then return
    the <code id=named-access-on-the-window-object:windowproxy><a href=#windowproxy>WindowProxy</a></code> object of the <a href=#nested-browsing-context id=named-access-on-the-window-object:nested-browsing-context-2>nested browsing context</a> corresponding to
    the first <a href=#browsing-context-container id=named-access-on-the-window-object:browsing-context-container-2>browsing context container</a> in <a id=named-access-on-the-window-object:tree-order-2 href=https://dom.spec.whatwg.org/#concept-tree-order data-x-internal=tree-order>tree order</a> whose
    <a href=#nested-browsing-context id=named-access-on-the-window-object:nested-browsing-context-3>nested browsing context</a> is in <var>objects</var>, and abort these steps.</p>

   <li>

    <p>Otherwise, if <var>objects</var> has only one element, return that element and
    abort these steps.</p>

   <li>

    <p>Otherwise return an <code id=named-access-on-the-window-object:htmlcollection><a data-x-internal=htmlcollection href=https://dom.spec.whatwg.org/#interface-htmlcollection>HTMLCollection</a></code> rooted at the <code id=named-access-on-the-window-object:document><a href=#document>Document</a></code> node,
    whose filter matches only <a href=#dom-window-nameditem-filter id=named-access-on-the-window-object:dom-window-nameditem-filter-2>named objects</a> with
    the name <var>name</var>. (By definition, these will all be elements.)</p> 

   </ol>

  <p><dfn id=dom-window-nameditem-filter>Named objects</dfn> with the name <var>name</var>,
  for the purposes of the above algorithm, consist of the following:</p>

  <ul><li><p><a href=#document-tree-child-browsing-context id=named-access-on-the-window-object:document-tree-child-browsing-context-4>document-tree child browsing
   contexts</a> of the <a href=#active-document id=named-access-on-the-window-object:active-document-5>active document</a> whose name is <var>name</var>;<li><p><code id=named-access-on-the-window-object:the-a-element><a href=#the-a-element>a</a></code>, <code id=named-access-on-the-window-object:the-applet-element-2><a href=#the-applet-element>applet</a></code>, <code id=named-access-on-the-window-object:the-area-element><a href=#the-area-element>area</a></code>, <code id=named-access-on-the-window-object:the-embed-element-2><a href=#the-embed-element>embed</a></code>,
   <code id=named-access-on-the-window-object:the-form-element-2><a href=#the-form-element>form</a></code>, <code id=named-access-on-the-window-object:frameset-2><a href=#frameset>frameset</a></code>, <code id=named-access-on-the-window-object:the-img-element-2><a href=#the-img-element>img</a></code>, or <code id=named-access-on-the-window-object:the-object-element-2><a href=#the-object-element>object</a></code> elements that
   have a <code>name</code> content attribute whose value is <var>name</var> and are
   <a id=named-access-on-the-window-object:in-a-document-tree-3 href=https://dom.spec.whatwg.org/#in-a-document-tree data-x-internal=in-a-document-tree>in a document tree</a> with the <a href=#active-document id=named-access-on-the-window-object:active-document-6>active document</a> as their
   <a id=named-access-on-the-window-object:root-3 href=https://dom.spec.whatwg.org/#concept-tree-root data-x-internal=root>root</a>; and<li><p><a href=#html-elements id=named-access-on-the-window-object:html-elements-2>HTML elements</a> that have an <code id=named-access-on-the-window-object:the-id-attribute-3><a href=#the-id-attribute>id</a></code> content attribute
   whose value is <var>name</var> and are <a id=named-access-on-the-window-object:in-a-document-tree-4 href=https://dom.spec.whatwg.org/#in-a-document-tree data-x-internal=in-a-document-tree>in a document tree</a> with the <a href=#active-document id=named-access-on-the-window-object:active-document-7>active
   document</a> as their <a id=named-access-on-the-window-object:root-4 href=https://dom.spec.whatwg.org/#concept-tree-root data-x-internal=root>root</a>.</ul>

  


  

  <h4 id=garbage-collection-and-browsing-contexts>7.3.4 Garbage collection and browsing contexts<a href=#garbage-collection-and-browsing-contexts class=self-link></a></h4>

  <p>A <a href=#browsing-context id=garbage-collection-and-browsing-contexts:browsing-context>browsing context</a> has a strong reference to each of its <code id=garbage-collection-and-browsing-contexts:document><a href=#document>Document</a></code>s
  and its <code id=garbage-collection-and-browsing-contexts:windowproxy><a href=#windowproxy>WindowProxy</a></code> object, and the user agent itself has a strong reference to its
  <a href=#top-level-browsing-context id=garbage-collection-and-browsing-contexts:top-level-browsing-context>top-level browsing contexts</a>.</p>

  <p>A <code id=garbage-collection-and-browsing-contexts:document-2><a href=#document>Document</a></code> has a strong reference to its <code id=garbage-collection-and-browsing-contexts:window><a href=#window>Window</a></code> object.</p>

  <p class=note>A <code id=garbage-collection-and-browsing-contexts:window-2><a href=#window>Window</a></code> object <a href=#implied-strong-reference id=garbage-collection-and-browsing-contexts:implied-strong-reference>has a strong
  reference</a> to its <code id=garbage-collection-and-browsing-contexts:document-3><a href=#document>Document</a></code> object through its <code id=garbage-collection-and-browsing-contexts:dom-document-2><a href=#dom-document-2>document</a></code> attribute. Thus, references from other scripts to either of
  those objects will keep both alive. Similarly, both <code id=garbage-collection-and-browsing-contexts:document-4><a href=#document>Document</a></code> and <code id=garbage-collection-and-browsing-contexts:window-3><a href=#window>Window</a></code>
  objects have <a href=#implied-strong-reference id=garbage-collection-and-browsing-contexts:implied-strong-reference-2>implied strong references</a> to the
  <code id=garbage-collection-and-browsing-contexts:windowproxy-2><a href=#windowproxy>WindowProxy</a></code> object.</p>

  <p>Each <a href=#concept-script id=garbage-collection-and-browsing-contexts:concept-script>script</a> has a strong reference to its <a href=#settings-object id=garbage-collection-and-browsing-contexts:settings-object>settings
  object</a>, and each <a href=#environment-settings-object id=garbage-collection-and-browsing-contexts:environment-settings-object>environment settings object</a> has strong references to its
  <a href=#concept-settings-object-global id=garbage-collection-and-browsing-contexts:concept-settings-object-global>global object</a>, <a href=#responsible-browsing-context id=garbage-collection-and-browsing-contexts:responsible-browsing-context>responsible browsing
  context</a>, and <a href=#responsible-document id=garbage-collection-and-browsing-contexts:responsible-document>responsible document</a> (if any).</p>

  
  <p>When a <a href=#browsing-context id=garbage-collection-and-browsing-contexts:browsing-context-2>browsing context</a> is to <dfn id=discard-a-document data-export="">discard a
  <code>Document</code></dfn>, the user agent must run the following steps:</p>

  <ol><li><p>Set the <code id=garbage-collection-and-browsing-contexts:document-5><a href=#document>Document</a></code>'s <i id=garbage-collection-and-browsing-contexts:concept-document-salvageable><a href=#concept-document-salvageable>salvageable</a></i> state to false.<li><p>Run any <a href=#unloading-document-cleanup-steps id=garbage-collection-and-browsing-contexts:unloading-document-cleanup-steps>unloading document cleanup steps</a> for the <code id=garbage-collection-and-browsing-contexts:document-6><a href=#document>Document</a></code> that
   are defined by this specification and <a href=#other-applicable-specifications id=garbage-collection-and-browsing-contexts:other-applicable-specifications>other applicable specifications</a>.<li><p><a href=#abort-a-document id=garbage-collection-and-browsing-contexts:abort-a-document>Abort the <code>Document</code></a>.<li><p>Remove any <a href=#concept-task id=garbage-collection-and-browsing-contexts:concept-task>tasks</a> associated with the
   <code id=garbage-collection-and-browsing-contexts:document-7><a href=#document>Document</a></code> in any <a href=#task-source id=garbage-collection-and-browsing-contexts:task-source>task source</a>, without running those tasks.<li><p><a href=#a-browsing-context-is-discarded id=garbage-collection-and-browsing-contexts:a-browsing-context-is-discarded>Discard</a> all the <a href=#child-browsing-context id=garbage-collection-and-browsing-contexts:child-browsing-context>child browsing contexts</a> of the <code id=garbage-collection-and-browsing-contexts:document-8><a href=#document>Document</a></code>.<li><p>Lose the strong reference from the <code id=garbage-collection-and-browsing-contexts:document-9><a href=#document>Document</a></code>'s <a href=#concept-document-bc id=garbage-collection-and-browsing-contexts:concept-document-bc>browsing context</a> to the <code id=garbage-collection-and-browsing-contexts:document-10><a href=#document>Document</a></code>.</ol>

  <p class=note>Whenever a <code id=garbage-collection-and-browsing-contexts:document-11><a href=#document>Document</a></code> object is <a href=#discard-a-document id=garbage-collection-and-browsing-contexts:discard-a-document>discarded</a>, it is also removed from the list of <a href="#the-worker's-documents" id="garbage-collection-and-browsing-contexts:the-worker's-documents">the worker's
  <code>Document</code>s</a> of each worker whose list contains that <code id=garbage-collection-and-browsing-contexts:document-12><a href=#document>Document</a></code>.</p>

  <p>When <dfn id=a-browsing-context-is-discarded data-export="">a <em>browsing context</em> is discarded</dfn>, the strong reference
  from the user agent itself to the <a href=#browsing-context id=garbage-collection-and-browsing-contexts:browsing-context-3>browsing context</a> must be severed, and all the
  <code id=garbage-collection-and-browsing-contexts:document-13><a href=#document>Document</a></code> objects for all the entries in the <a href=#browsing-context id=garbage-collection-and-browsing-contexts:browsing-context-4>browsing context</a>'s session
  history must be <a href=#discard-a-document id=garbage-collection-and-browsing-contexts:discard-a-document-2>discarded</a> as well.</p>

  <p>User agents may <a href=#a-browsing-context-is-discarded id=garbage-collection-and-browsing-contexts:a-browsing-context-is-discarded-2>discard</a> <a href=#top-level-browsing-context id=garbage-collection-and-browsing-contexts:top-level-browsing-context-2>top-level browsing contexts</a> at any time (typically, in
  response to user requests, e.g. when a user force-closes a window containing one or more <a href=#top-level-browsing-context id=garbage-collection-and-browsing-contexts:top-level-browsing-context-3>top-level browsing contexts</a>). Other <a href=#browsing-context id=garbage-collection-and-browsing-contexts:browsing-context-5>browsing contexts</a> must be discarded once their
  <code id=garbage-collection-and-browsing-contexts:windowproxy-3><a href=#windowproxy>WindowProxy</a></code> object is eligible for garbage collection, in addition to the other
  places where this specification requires them to be discarded.</p>

  <p>A <code id=garbage-collection-and-browsing-contexts:windowproxy-4><a href=#windowproxy>WindowProxy</a></code> does <em>not</em> have a strong reference to the <a href=#browsing-context id=garbage-collection-and-browsing-contexts:browsing-context-6>browsing
  context</a> it was created alongside. In particular, it is possible for a <a href=#nested-browsing-context id=garbage-collection-and-browsing-contexts:nested-browsing-context>nested
  browsing context</a> to be <a href=#a-browsing-context-is-discarded id=garbage-collection-and-browsing-contexts:a-browsing-context-is-discarded-3>discarded</a> even
  if JavaScript code holds a reference to its <code id=garbage-collection-and-browsing-contexts:windowproxy-5><a href=#windowproxy>WindowProxy</a></code> object.</p>

  


  <h4 id=closing-browsing-contexts>7.3.5 Closing browsing contexts<a href=#closing-browsing-contexts class=self-link></a></h4>

  <p>When the user agent is required to <dfn id=close-a-browsing-context>close a browsing context</dfn>, it must run the
  following steps:</p>

  <ol><li><p>Let <var>specified browsing context</var> be the <a href=#browsing-context id=closing-browsing-contexts:browsing-context>browsing context</a>
   being closed.<li><p><a href=#prompt-to-unload-a-document id=closing-browsing-contexts:prompt-to-unload-a-document>Prompt to unload</a> the <a href=#active-document id=closing-browsing-contexts:active-document>active
   document</a> of the <var>specified browsing context</var>. If the user <a href=#refused-to-allow-the-document-to-be-unloaded id=closing-browsing-contexts:refused-to-allow-the-document-to-be-unloaded>refused
   to allow the document to be unloaded</a>, then abort these steps.<li><p><a href=#unload-a-document id=closing-browsing-contexts:unload-a-document>Unload</a> the <a href=#active-document id=closing-browsing-contexts:active-document-2>active document</a> of the <var>specified browsing context</var> with the <var>recycle</var> parameter set to
   false.<li><p>Remove the <var>specified browsing context</var> from the user interface (e.g.
   close or hide its tab in a tabbed browser).<li><p><a href=#a-browsing-context-is-discarded id=closing-browsing-contexts:a-browsing-context-is-discarded>Discard</a> the <var>specified
   browsing context</var>.</ol>

  <p>User agents should offer users the ability to arbitrarily <a href=#close-a-browsing-context id=closing-browsing-contexts:close-a-browsing-context>close</a> any <a href=#top-level-browsing-context id=closing-browsing-contexts:top-level-browsing-context>top-level browsing context</a>.</p>



  <h4 id=browser-interface-elements>7.3.6 Browser interface elements<a href=#browser-interface-elements class=self-link></a></h4>

  <p>To allow Web pages to integrate with Web browsers, certain Web browser interface elements are
  exposed in a limited way to scripts in Web pages.</p>

  <p>Each interface element is represented by a <code id=browser-interface-elements:barprop><a href=#barprop>BarProp</a></code> object:</p>

  <pre class=idl>interface <dfn id=barprop>BarProp</dfn> {
  readonly attribute boolean <a href=#dom-barprop-visible id=browser-interface-elements:dom-barprop-visible>visible</a>;
};</pre>

  <dl class=domintro><dt><var>window</var> . <code id=browser-interface-elements:dom-window-locationbar><a href=#dom-window-locationbar>locationbar</a></code> . <code id=browser-interface-elements:dom-barprop-visible-2><a href=#dom-barprop-visible>visible</a></code><dd>
    <p>Returns true if the location bar is visible; otherwise, returns false.</p>
   <dt><var>window</var> . <code id=browser-interface-elements:dom-window-menubar><a href=#dom-window-menubar>menubar</a></code> . <code id=browser-interface-elements:dom-barprop-visible-3><a href=#dom-barprop-visible>visible</a></code><dd>
    <p>Returns true if the menu bar is visible; otherwise, returns false.</p>
   <dt><var>window</var> . <code id=browser-interface-elements:dom-window-personalbar><a href=#dom-window-personalbar>personalbar</a></code> . <code id=browser-interface-elements:dom-barprop-visible-4><a href=#dom-barprop-visible>visible</a></code><dd>
    <p>Returns true if the personal bar is visible; otherwise, returns false.</p>
   <dt><var>window</var> . <code id=browser-interface-elements:dom-window-scrollbars><a href=#dom-window-scrollbars>scrollbars</a></code> . <code id=browser-interface-elements:dom-barprop-visible-5><a href=#dom-barprop-visible>visible</a></code><dd>
    <p>Returns true if the scroll bars are visible; otherwise, returns false.</p>
   <dt><var>window</var> . <code id=browser-interface-elements:dom-window-statusbar><a href=#dom-window-statusbar>statusbar</a></code> . <code id=browser-interface-elements:dom-barprop-visible-6><a href=#dom-barprop-visible>visible</a></code><dd>
    <p>Returns true if the status bar is visible; otherwise, returns false.</p>
   <dt><var>window</var> . <code id=browser-interface-elements:dom-window-toolbar><a href=#dom-window-toolbar>toolbar</a></code> . <code id=browser-interface-elements:dom-barprop-visible-7><a href=#dom-barprop-visible>visible</a></code><dd>
    <p>Returns true if the toolbar is visible; otherwise, returns false.</p>
   </dl>

  

  <p>The <dfn id=dom-barprop-visible>visible</dfn> attribute, on getting, must return either
  true or a value determined by the user agent to most accurately represent the visibility state of
  the user interface element that the object represents, as described below.</p>

  <p>The following <code id=browser-interface-elements:barprop-2><a href=#barprop>BarProp</a></code> objects exist for each <code id=browser-interface-elements:document><a href=#document>Document</a></code> object in a
  <a href=#browsing-context id=browser-interface-elements:browsing-context>browsing context</a>. Some of the user interface elements represented by these objects
  might have no equivalent in some user agents; for those user agents, except when otherwise
  specified, the object must act as if it was present and visible (i.e. its <code id=browser-interface-elements:dom-barprop-visible-8><a href=#dom-barprop-visible>visible</a></code> attribute must return true).</p>

  <dl><dt><dfn id=the-location-bar-barprop-object>The location bar <code>BarProp</code> object</dfn><dd>Represents the user interface element that contains a control that displays the
   <a id=browser-interface-elements:url href=https://url.spec.whatwg.org/#concept-url data-x-internal=url>URL</a> of the <a href=#active-document id=browser-interface-elements:active-document>active document</a>, or some similar interface concept.<dt><dfn id=the-menu-bar-barprop-object>The menu bar <code>BarProp</code> object</dfn><dd>Represents the user interface element that contains a list of commands in menu form, or some
   similar interface concept.<dt><dfn id=the-personal-bar-barprop-object>The personal bar <code>BarProp</code> object</dfn><dd>Represents the user interface element that contains links to the user's favorite pages, or
   some similar interface concept.<dt><dfn id=the-scrollbar-barprop-object>The scrollbar <code>BarProp</code> object</dfn><dd>Represents the user interface element that contains a scrolling mechanism, or some similar
   interface concept.<dt><dfn id=the-status-bar-barprop-object>The status bar <code>BarProp</code> object</dfn><dd>Represents a user interface element found immediately below or after the document, as
   appropriate for the user's media, which typically provides information about ongoing network
   activity or information about elements that the user's pointing device is current indicating. If
   the user agent has no such user interface element, then the object may act as if the
   corresponding user interface element was absent (i.e. its <code id=browser-interface-elements:dom-barprop-visible-9><a href=#dom-barprop-visible>visible</a></code> attribute may return false).<dt><dfn id=the-toolbar-barprop-object>The toolbar <code>BarProp</code> object</dfn><dd>Represents the user interface element found immediately above or before the document, as
   appropriate for the user's media, which typically provides <a href=#session-history id=browser-interface-elements:session-history>session history</a> traversal
   controls (back and forward buttons, reload buttons, etc). If the user agent has no such user
   interface element, then the object may act as if the corresponding user interface element was
   absent (i.e. its <code id=browser-interface-elements:dom-barprop-visible-10><a href=#dom-barprop-visible>visible</a></code> attribute may return
   false).</dl>

  <p>The <dfn id=dom-window-locationbar><code>locationbar</code></dfn> attribute must return
  <a href=#the-location-bar-barprop-object id=browser-interface-elements:the-location-bar-barprop-object>the location bar <code>BarProp</code> object</a>.</p>

  <p>The <dfn id=dom-window-menubar><code>menubar</code></dfn> attribute must return <a href=#the-menu-bar-barprop-object id=browser-interface-elements:the-menu-bar-barprop-object>the
  menu bar <code>BarProp</code> object</a>.</p>

  <p>The <dfn id=dom-window-personalbar><code>personalbar</code></dfn> attribute must return
  <a href=#the-personal-bar-barprop-object id=browser-interface-elements:the-personal-bar-barprop-object>the personal bar <code>BarProp</code> object</a>.</p>

  <p>The <dfn id=dom-window-scrollbars><code>scrollbars</code></dfn> attribute must return
  <a href=#the-scrollbar-barprop-object id=browser-interface-elements:the-scrollbar-barprop-object>the scrollbar <code>BarProp</code> object</a>.</p>

  <p>The <dfn id=dom-window-statusbar><code>statusbar</code></dfn> attribute must return
  <a href=#the-status-bar-barprop-object id=browser-interface-elements:the-status-bar-barprop-object>the status bar <code>BarProp</code> object</a>.</p>

  <p>The <dfn id=dom-window-toolbar><code>toolbar</code></dfn> attribute must return <a href=#the-toolbar-barprop-object id=browser-interface-elements:the-toolbar-barprop-object>the
  toolbar <code>BarProp</code> object</a>.</p>



  <hr>

  <p>For historical reasons, the <dfn id=dom-window-status><code>status</code></dfn> attribute
  on the <code id=browser-interface-elements:window><a href=#window>Window</a></code> object must, on getting, return the last string it was set to, and on
  setting, must set itself to the new value. When the <code id=browser-interface-elements:window-2><a href=#window>Window</a></code> object is created, the
  attribute must be set to the empty string. It does not do anything else.</p>

  


  

  <h3 id=the-windowproxy-exotic-object>7.4 The <code id=the-windowproxy-exotic-object:windowproxy><a href=#windowproxy>WindowProxy</a></code> exotic object<a href=#the-windowproxy-exotic-object class=self-link></a></h3>

  <p>A <dfn id=windowproxy data-dfn-type=interface data-export=""><code>WindowProxy</code></dfn> is an exotic
  object that wraps a <code id=the-windowproxy-exotic-object:window><a href=#window>Window</a></code> ordinary object, indirecting most operations through to
  the wrapped object. Each <a href=#browsing-context id=the-windowproxy-exotic-object:browsing-context>browsing context</a> has an associated <code id=the-windowproxy-exotic-object:windowproxy-2><a href=#windowproxy>WindowProxy</a></code>
  object. When the <a href=#browsing-context id=the-windowproxy-exotic-object:browsing-context-2>browsing context</a> is <a href=#navigate id=the-windowproxy-exotic-object:navigate>navigated</a>, the
  <code id=the-windowproxy-exotic-object:window-2><a href=#window>Window</a></code> object wrapped by the <a href=#browsing-context id=the-windowproxy-exotic-object:browsing-context-3>browsing context</a>'s associated
  <code id=the-windowproxy-exotic-object:windowproxy-3><a href=#windowproxy>WindowProxy</a></code> object is changed.</p>

  <p>There is no <code id=the-windowproxy-exotic-object:windowproxy-4><a href=#windowproxy>WindowProxy</a></code> <a id=the-windowproxy-exotic-object:interface-object href=https://heycam.github.io/webidl/#dfn-interface-object data-x-internal=interface-object>interface object</a>.</p>

  <p>Every <code id=the-windowproxy-exotic-object:windowproxy-5><a href=#windowproxy>WindowProxy</a></code> object has a
  <dfn id=concept-windowproxy-window>[[Window]]</dfn> internal slot representing the wrapped
  <code id=the-windowproxy-exotic-object:window-3><a href=#window>Window</a></code> object.</p>

  <p>The <code id=the-windowproxy-exotic-object:windowproxy-6><a href=#windowproxy>WindowProxy</a></code> object internal methods are described in the subsections
  below.</p>

  <p class=note>Although <code id=the-windowproxy-exotic-object:windowproxy-7><a href=#windowproxy>WindowProxy</a></code> is named as a "proxy", it does not do
  polymorphic dispatch on its target's internal methods as a real proxy would, due to a desire to
  reuse machinery between <code id=the-windowproxy-exotic-object:windowproxy-8><a href=#windowproxy>WindowProxy</a></code> and <code id=the-windowproxy-exotic-object:location><a href=#location>Location</a></code> objects. As long as the
  <code id=the-windowproxy-exotic-object:window-4><a href=#window>Window</a></code> object remains an ordinary object this is unobservable and can be implemented
  either way.</p>

  <h4 id=windowproxy-getprototypeof>7.4.1 [[GetPrototypeOf]] ( )<a href=#windowproxy-getprototypeof class=self-link></a></h4>

  <ol><li><p>Let <var>W</var> be the value of the
   <a href=#concept-windowproxy-window id=windowproxy-getprototypeof:concept-windowproxy-window>[[Window]]</a> internal slot of
   <b>this</b>.<li><p>If <a href=#isplatformobjectsameorigin-(-o-) id=windowproxy-getprototypeof:isplatformobjectsameorigin-(-o-)>IsPlatformObjectSameOrigin</a>(<var>W</var>) is true, then return !
   <a id=windowproxy-getprototypeof:ordinarygetprototypeof href=https://tc39.github.io/ecma262/#sec-ordinarygetprototypeof data-x-internal=ordinarygetprototypeof>OrdinaryGetPrototypeOf</a>(<var>W</var>).<li><p>Return null.</ol>

  <h4 id=windowproxy-setprototypeof>7.4.2 [[SetPrototypeOf]] ( <var>V</var> )<a href=#windowproxy-setprototypeof class=self-link></a></h4>

  <ol><li><p>Return false.</ol>

  <h4 id=windowproxy-isextensible>7.4.3 [[IsExtensible]] ( )<a href=#windowproxy-isextensible class=self-link></a></h4>

  <ol><li><p>Return true.</ol>

  <h4 id=windowproxy-preventextensions>7.4.4 [[PreventExtensions]] ( )<a href=#windowproxy-preventextensions class=self-link></a></h4>

  <ol><li><p>Return false.</ol>

  <h4 id=windowproxy-getownproperty>7.4.5 [[GetOwnProperty]] ( <var>P</var> )<a href=#windowproxy-getownproperty class=self-link></a></h4>

  <ol><li><p>Let <var>W</var> be the value of the
   <a href=#concept-windowproxy-window id=windowproxy-getownproperty:concept-windowproxy-window>[[Window]]</a> internal slot of
   <b>this</b>.<li>
    <p>If <var>P</var> is an <a id=windowproxy-getownproperty:array-index-property-name href=https://heycam.github.io/webidl/#dfn-array-index-property-name data-x-internal=array-index-property-name>array index property name</a>, then:</p>

    <ol><li><p>Let <var>index</var> be <a id=windowproxy-getownproperty:touint32 href=https://tc39.github.io/ecma262/#sec-touint32 data-x-internal=touint32>ToUint32</a>(<var>P</var>).<li><p>Let <var>maxProperties</var> be the <a href=#number-of-document-tree-child-browsing-contexts id=windowproxy-getownproperty:number-of-document-tree-child-browsing-contexts>number of document-tree child browsing
     contexts</a> of <var>W</var>.<li><p>Let <var>value</var> be undefined.<li>
      <p>If <var>maxProperties</var> is greater than 0 and <var>index</var> is less than
      <var>maxProperties</var>, then:</p>

      <ol><li><p>Let <var>document</var> be <var>W</var>'s <a href=#concept-document-window id=windowproxy-getownproperty:concept-document-window>associated <code>Document</code></a>.<li><p>Set <var>value</var> to the <code id=windowproxy-getownproperty:windowproxy><a href=#windowproxy>WindowProxy</a></code> object of the <var>index</var>th
       <a href=#document-tree-child-browsing-context id=windowproxy-getownproperty:document-tree-child-browsing-context>document-tree child browsing context</a> of <var>document</var>'s <a href=#concept-document-bc id=windowproxy-getownproperty:concept-document-bc>browsing context</a>, sorted in the order
       that their <a href=#browsing-context-container id=windowproxy-getownproperty:browsing-context-container>browsing context container</a>
       elements were most recently inserted into <var>document</var>, the
       <code id=windowproxy-getownproperty:windowproxy-2><a href=#windowproxy>WindowProxy</a></code> object of the most recently inserted <a href=#browsing-context-container id=windowproxy-getownproperty:browsing-context-container-2>browsing context
       container</a>'s <a href=#nested-browsing-context id=windowproxy-getownproperty:nested-browsing-context>nested browsing context</a> being last.</ol>

     <li><p>Return <a id=windowproxy-getownproperty:propertydescriptor href=https://tc39.github.io/ecma262/#sec-property-descriptor-specification-type data-x-internal=propertydescriptor>PropertyDescriptor</a>{
     [[Value]]: <var>value</var>,
     [[Writable]]: false,
     [[Enumerable]]: false,
     [[Configurable]]: true }.</ol>
   <li>
    <p>If <a href=#isplatformobjectsameorigin-(-o-) id=windowproxy-getownproperty:isplatformobjectsameorigin-(-o-)>IsPlatformObjectSameOrigin</a>(<var>W</var>) is true, then return
    <a id=windowproxy-getownproperty:ordinarygetownproperty href=https://tc39.github.io/ecma262/#sec-ordinarygetownproperty data-x-internal=ordinarygetownproperty>OrdinaryGetOwnProperty</a>(<var>W</var>, <var>P</var>).</p>

    <p class=note>This is a <a href=#willful-violation id=windowproxy-getownproperty:willful-violation>willful violation</a> of the JavaScript specification's
    <a id=windowproxy-getownproperty:invariants-of-the-essential-internal-methods href=https://tc39.github.io/ecma262/#sec-invariants-of-the-essential-internal-methods data-x-internal=invariants-of-the-essential-internal-methods>invariants of the essential internal methods</a> to maintain compatibility with
    existing Web content. See <a href=https://github.com/tc39/ecma262/issues/672>tc39/ecma262
    issue #672</a> for more information. <a href=#refsJAVASCRIPT>[JAVASCRIPT]</a></p>
   <li><p>Let <var>property</var> be <a href=#crossorigingetownpropertyhelper-(-o,-p-) id=windowproxy-getownproperty:crossorigingetownpropertyhelper-(-o,-p-)>CrossOriginGetOwnPropertyHelper</a>(<var>W</var>,
   <var>P</var>).<li><p>If <var>property</var> is not undefined, return <var>property</var>.<li>
    <p>If <var>property</var> is undefined and <var>P</var> is in <var>W</var>'s <a href=#document-tree-child-browsing-context-name-property-set id=windowproxy-getownproperty:document-tree-child-browsing-context-name-property-set>document-tree
    child browsing context name property set</a>, then:</p>

    <ol><li><p>Let <var>value</var> be the <code id=windowproxy-getownproperty:windowproxy-3><a href=#windowproxy>WindowProxy</a></code> object of the
     <a href=#dom-window-nameditem-filter id=windowproxy-getownproperty:dom-window-nameditem-filter>named object</a> with the name <var>P</var>.

     <li><p>Return <a id=windowproxy-getownproperty:propertydescriptor-2 href=https://tc39.github.io/ecma262/#sec-property-descriptor-specification-type data-x-internal=propertydescriptor>PropertyDescriptor</a>{
     [[Value]]: <var>value</var>,
     [[Enumerable]]: false,
     [[Writable]]: false,
     [[Configurable]]: true }.</ol>

   <li><p>Throw a <a id=windowproxy-getownproperty:securityerror href=https://heycam.github.io/webidl/#securityerror data-x-internal=securityerror>"<code>SecurityError</code>"</a> <code id=windowproxy-getownproperty:domexception><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code>.</ol>

  <h4 id=windowproxy-defineownproperty>7.4.6 [[DefineOwnProperty]] ( <var>P</var>, <var>Desc</var>
  )<a href=#windowproxy-defineownproperty class=self-link></a></h4>

  <ol><li><p>Let <var>W</var> be the value of the
   <a href=#concept-windowproxy-window id=windowproxy-defineownproperty:concept-windowproxy-window>[[Window]]</a> internal slot of
   <b>this</b>.<li>
    <p>If <a href=#isplatformobjectsameorigin-(-o-) id=windowproxy-defineownproperty:isplatformobjectsameorigin-(-o-)>IsPlatformObjectSameOrigin</a>(<var>W</var>) is true, then:

    <ol><li><p>If <var>P</var> is an <a id=windowproxy-defineownproperty:array-index-property-name href=https://heycam.github.io/webidl/#dfn-array-index-property-name data-x-internal=array-index-property-name>array index property name</a>, return false.<li>
      <p>Return ? <a id=windowproxy-defineownproperty:ordinarydefineownproperty href=https://tc39.github.io/ecma262/#sec-ordinarydefineownproperty data-x-internal=ordinarydefineownproperty>OrdinaryDefineOwnProperty</a>(<var>W</var>, <var>P</var>,
      <var>Desc</var>).</p>

      <p class=note>This is a <a href=#willful-violation id=windowproxy-defineownproperty:willful-violation>willful violation</a> of the JavaScript specification's
      <a id=windowproxy-defineownproperty:invariants-of-the-essential-internal-methods href=https://tc39.github.io/ecma262/#sec-invariants-of-the-essential-internal-methods data-x-internal=invariants-of-the-essential-internal-methods>invariants of the essential internal methods</a> to maintain compatibility with
      existing Web content. See <a href=https://github.com/tc39/ecma262/issues/672>tc39/ecma262
      issue #672</a> for more information. <a href=#refsJAVASCRIPT>[JAVASCRIPT]</a></p>
     </ol>

   <li><p>Throw a <a id=windowproxy-defineownproperty:securityerror href=https://heycam.github.io/webidl/#securityerror data-x-internal=securityerror>"<code>SecurityError</code>"</a> <code id=windowproxy-defineownproperty:domexception><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code>.</ol>

  <h4 id=windowproxy-get>7.4.7 [[Get]] ( <var>P</var>, <var>Receiver</var> )<a href=#windowproxy-get class=self-link></a></h4>

  <ol><li><p>Let <var>W</var> be the value of the
   <a href=#concept-windowproxy-window id=windowproxy-get:concept-windowproxy-window>[[Window]]</a> internal slot of
   <b>this</b>.<li><p>If <a href=#isplatformobjectsameorigin-(-o-) id=windowproxy-get:isplatformobjectsameorigin-(-o-)>IsPlatformObjectSameOrigin</a>(<var>W</var>) is true, then return ?
   <a id=windowproxy-get:ordinaryget href=https://tc39.github.io/ecma262/#sec-ordinaryget data-x-internal=ordinaryget>OrdinaryGet</a>(<b>this</b>, <var>P</var>, <var>Receiver</var>).<li><p>Return ? <a href=#crossoriginget-(-o,-p,-receiver-) id=windowproxy-get:crossoriginget-(-o,-p,-receiver-)>CrossOriginGet</a>(<b>this</b>, <var>P</var>,
   <var>Receiver</var>).</ol>

  <h4 id=windowproxy-set>7.4.8 [[Set]] ( <var>P</var>, <var>V</var>, <var>Receiver</var> )<a href=#windowproxy-set class=self-link></a></h4>

  <ol><li><p>Let <var>W</var> be the value of the
   <a href=#concept-windowproxy-window id=windowproxy-set:concept-windowproxy-window>[[Window]]</a> internal slot of
   <b>this</b>.<li><p>If <a href=#isplatformobjectsameorigin-(-o-) id=windowproxy-set:isplatformobjectsameorigin-(-o-)>IsPlatformObjectSameOrigin</a>(<var>W</var>) is true, then return ?
   <a id=windowproxy-set:ordinaryset href=https://tc39.github.io/ecma262/#sec-ordinaryset data-x-internal=ordinaryset>OrdinarySet</a>(<var>W</var>, <b>this</b>, <var>Receiver</var>).<li><p>Return ? <a href=#crossoriginset-(-o,-p,-v,-receiver-) id=windowproxy-set:crossoriginset-(-o,-p,-v,-receiver-)>CrossOriginSet</a>(<b>this</b>, <var>P</var>, <var>V</var>,
   <var>Receiver</var>).</ol>

  <h4 id=windowproxy-delete>7.4.9 [[Delete]] ( <var>P</var> )<a href=#windowproxy-delete class=self-link></a></h4>

  <ol><li><p>Let <var>W</var> be the value of the
   <a href=#concept-windowproxy-window id=windowproxy-delete:concept-windowproxy-window>[[Window]]</a> internal slot of
   <b>this</b>.<li>
    <p>If <a href=#isplatformobjectsameorigin-(-o-) id=windowproxy-delete:isplatformobjectsameorigin-(-o-)>IsPlatformObjectSameOrigin</a>(<var>W</var>) is true, then:

    <ol><li><p>If <var>P</var> is an <a id=windowproxy-delete:array-index-property-name href=https://heycam.github.io/webidl/#dfn-array-index-property-name data-x-internal=array-index-property-name>array index property name</a>, then return
     false.<li><p>Return ? <a id=windowproxy-delete:ordinarydelete href=https://tc39.github.io/ecma262/#sec-ordinarydelete data-x-internal=ordinarydelete>OrdinaryDelete</a>(<var>W</var>, <var>P</var>).</ol>

   <li><p>Throw a <a id=windowproxy-delete:securityerror href=https://heycam.github.io/webidl/#securityerror data-x-internal=securityerror>"<code>SecurityError</code>"</a> <code id=windowproxy-delete:domexception><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code>.</ol>

  <h4 id=windowproxy-ownpropertykeys>7.4.10 [[OwnPropertyKeys]] ( )<a href=#windowproxy-ownpropertykeys class=self-link></a></h4>

  <ol><li><p>Let <var>W</var> be the value of the
   <a href=#concept-windowproxy-window id=windowproxy-ownpropertykeys:concept-windowproxy-window>[[Window]]</a> internal slot of
   <b>this</b>.<li><p>Let <var>keys</var> be a new empty <a href=https://tc39.github.io/ecma262/#sec-list-and-record-specification-type id=windowproxy-ownpropertykeys:js-list data-x-internal=js-list>List</a>.<li><p>Let <var>maxProperties</var> be the <a href=#number-of-document-tree-child-browsing-contexts id=windowproxy-ownpropertykeys:number-of-document-tree-child-browsing-contexts>number of document-tree child browsing
   contexts</a> of <var>W</var>.<li><p>Let <var>index</var> be 0.<li>
    <p>Repeat while <var>index</var> &lt; <var>maxProperties</var>,

    <ol><li><p>Add ! <a id=windowproxy-ownpropertykeys:tostring href=https://tc39.github.io/ecma262/#sec-tostring data-x-internal=tostring>ToString</a>(<var>index</var>) as the last element of
     <var>keys</var>.<li><p>Increment <var>index</var> by 1.</ol>
   <li><p>If <a href=#isplatformobjectsameorigin-(-o-) id=windowproxy-ownpropertykeys:isplatformobjectsameorigin-(-o-)>IsPlatformObjectSameOrigin</a>(<var>W</var>) is true, then return the
   concatenation of <var>keys</var> and !
   <a id=windowproxy-ownpropertykeys:ordinaryownpropertykeys href=https://tc39.github.io/ecma262/#sec-ordinaryownpropertykeys data-x-internal=ordinaryownpropertykeys>OrdinaryOwnPropertyKeys</a>(<var>W</var>).<li><p>Return the concatenation of <var>keys</var> and !
   <a href=#crossoriginownpropertykeys-(-o-) id=windowproxy-ownpropertykeys:crossoriginownpropertykeys-(-o-)>CrossOriginOwnPropertyKeys</a>(<var>W</var>).</ol>

  





  <h3 id=origin>7.5 Origin<a href=#origin class=self-link></a></h3><div class=status><input onclick=toggleStatus(this) value=â‹° type=button><p class=bugs><strong>Spec bugs:</strong> <a href="https://www.w3.org/Bugs/Public/show_bug.cgi?id=28374" title="Should canvas really get tainted by a cross-origin (via document.domain) drawImage call?">28374</a></div>
  

  <p>Origins are the fundamental currency of the Web's security model. Two actors in the Web
  platform that share an origin are assumed to trust each other and to have the same authority.
  Actors with differing origins are considered potentially hostile versus each other, and are
  isolated from each other to varying degrees.</p>

  <p class=example>For example, if Example Bank's Web site, hosted at <code>bank.example.com</code>, tries to examine the DOM of Example Charity's Web site, hosted
  at <code>charity.example.org</code>, a <a id=origin:securityerror href=https://heycam.github.io/webidl/#securityerror data-x-internal=securityerror>"<code>SecurityError</code>"</a>
  <code id=origin:domexception><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code> will be raised.</p>

  <hr>

  <p id=origin-2>An <dfn data-export="" id=concept-origin>origin</dfn> is
  one of the following:</p>

  <dl><dt>An <dfn id=concept-origin-opaque data-export="">opaque origin</dfn><dd><p>An internal value, with no serialization it can be recreated from (it is serialized as
   "<code>null</code>" per <a href=#ascii-serialisation-of-an-origin id=origin:ascii-serialisation-of-an-origin>ASCII serialization of an origin</a>), for which the
   only meaningful operation is testing for equality.<dt>A <dfn id=concept-origin-tuple data-export="">tuple origin</dfn><dd>
    <p>A <a href=#concept-origin-tuple id=origin:concept-origin-tuple>tuple</a> consists of:

    <ul class=brief><li>A <dfn data-dfn-for=origin id=concept-origin-scheme data-export="">scheme</dfn> (a
     <a href=https://url.spec.whatwg.org/#concept-url-scheme id=origin:concept-url-scheme data-x-internal=concept-url-scheme>scheme</a>).<li>A <dfn data-dfn-for=origin id=concept-origin-host data-export="">host</dfn> (a
     <a href=https://url.spec.whatwg.org/#concept-host id=origin:concept-host data-x-internal=concept-host>host</a>).<li>A <dfn data-dfn-for=origin id=concept-origin-port data-export="">port</dfn> (a
     <a href=https://url.spec.whatwg.org/#concept-url-port id=origin:concept-url-port data-x-internal=concept-url-port>port</a>).<li>A <dfn data-dfn-for=origin id=concept-origin-domain data-export="">domain</dfn>
     (null or a <a href=https://url.spec.whatwg.org/#concept-domain id=origin:concept-domain data-x-internal=concept-domain>domain</a>). Null unless stated otherwise.</ul>
   </dl>

  <p class=note><a href=#concept-origin id=origin:concept-origin>Origins</a> can be shared, e.g., among multiple
  <code id=origin:document><a href=#document>Document</a></code> objects. Furthermore, <a href=#concept-origin id=origin:concept-origin-2>origins</a> are generally
  immutable. Only the <a href=#concept-origin-domain id=origin:concept-origin-domain>domain</a> of a <a href=#concept-origin-tuple id=origin:concept-origin-tuple-2>tuple origin</a> can be changed, and only through the <code id=origin:dom-document-domain><a href=#dom-document-domain>document.domain</a></code> API.</p>

  <p>The <dfn id=concept-origin-effective-domain data-export="">effective domain</dfn> of an
  <a href=#concept-origin id=origin:concept-origin-3>origin</a> <var>origin</var> is computed as follows:</p>

  <ol><li><p>If <var>origin</var> is an <a href=#concept-origin-opaque id=origin:concept-origin-opaque>opaque origin</a>, then
   return <var>origin</var>.<li><p>If <var>origin</var>'s <a href=#concept-origin-domain id=origin:concept-origin-domain-2>domain</a> is non-null,
   then return <var>origin</var>'s <a href=#concept-origin-domain id=origin:concept-origin-domain-3>domain</a>.<li><p>Return <var>origin</var>'s <a href=#concept-origin-host id=origin:concept-origin-host>host</a>.</ol>

  

  <p>Various specification objects are defined to have an <a href=#concept-origin id=origin:concept-origin-4>origin</a>. These <a href=#concept-origin id=origin:concept-origin-5>origins</a> are determined as follows:</p>

  <dl><dt>For <code id=origin:document-2><a href=#document>Document</a></code> objects<dd>

    <dl class=switch><dt id=sandboxOrigin>If the <code id=origin:document-3><a href=#document>Document</a></code>'s <a href=#active-sandboxing-flag-set id=origin:active-sandboxing-flag-set>active sandboxing flag set</a>
     has its <a href=#sandboxed-origin-browsing-context-flag id=origin:sandboxed-origin-browsing-context-flag>sandboxed origin browsing context flag</a> set<dt>If the <code id=origin:document-4><a href=#document>Document</a></code> was generated from a <a href=https://tools.ietf.org/html/rfc2397#section-2 id=origin:data-protocol data-x-internal=data-protocol><code>data:</code> URL</a><dd><p>A unique <a href=#concept-origin-opaque id=origin:concept-origin-opaque-2>opaque origin</a> assigned when the
     <code id=origin:document-5><a href=#document>Document</a></code> is created.<dt>If the <code id=origin:document-6><a href=#document>Document</a></code>'s <a href=https://dom.spec.whatwg.org/#concept-document-url id="origin:the-document's-address" data-x-internal="the-document's-address">URL</a>'s <a href=https://url.spec.whatwg.org/#concept-url-scheme id=origin:concept-url-scheme-2 data-x-internal=concept-url-scheme>scheme</a> is a <a id=origin:network-scheme href=https://url.spec.whatwg.org/#network-scheme data-x-internal=network-scheme>network scheme</a><dd>
      <p>A copy of the <code id=origin:document-7><a href=#document>Document</a></code>'s <a href=https://dom.spec.whatwg.org/#concept-document-url id="origin:the-document's-address-2" data-x-internal="the-document's-address">URL</a>'s
      <a href=https://url.spec.whatwg.org/#concept-url-origin id=origin:concept-url-origin data-x-internal=concept-url-origin>origin</a> assigned when the <code id=origin:document-8><a href=#document>Document</a></code> is
      created.</p>

      <p class=note>The <code id=origin:dom-document-open><a href=#dom-document-open>document.open()</a></code> method can change
      the <code id=origin:document-9><a href=#document>Document</a></code>'s <a href=https://dom.spec.whatwg.org/#concept-document-url id="origin:the-document's-address-3" data-x-internal="the-document's-address">URL</a> to
      "<code id=origin:about:blank><a href=#about:blank>about:blank</a></code>". Therefore the <a href=#concept-origin id=origin:concept-origin-6>origin</a> is assigned when the
      <code id=origin:document-10><a href=#document>Document</a></code> is created.</p>
     <dt>If the <code id=origin:document-11><a href=#document>Document</a></code> is the initial "<code id=origin:about:blank-2><a href=#about:blank>about:blank</a></code>" document<dd><p><a href=#about-blank-origin>The one it was assigned when its browsing context was
     created</a>.<dt>If the <code id=origin:document-12><a href=#document>Document</a></code> is a non-initial "<code id=origin:about:blank-3><a href=#about:blank>about:blank</a></code>" document<dd><p>The <a href=#concept-settings-object-origin id=origin:concept-settings-object-origin>origin</a> of the <a href=#incumbent-settings-object id=origin:incumbent-settings-object>incumbent
     settings object</a> when the <a href=#navigate id=origin:navigate>navigate</a> algorithm was invoked, or, if no <a href=#concept-script id=origin:concept-script>script</a> was involved, the <a href=#concept-origin id=origin:concept-origin-7>origin</a> of the <a id=origin:node-document href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node
     document</a> of the element that initiated the <a href=#navigate id=origin:navigate-2>navigation</a> to
     that <a id=origin:url href=https://url.spec.whatwg.org/#concept-url data-x-internal=url>URL</a>.<dt>If the <code id=origin:document-13><a href=#document>Document</a></code> was created as part of the processing for <a href=#javascript-protocol id=origin:javascript-protocol><code>javascript:</code> URLs</a><dd><p>The <a href=#concept-origin id=origin:concept-origin-8>origin</a> of the <a href=#active-document id=origin:active-document>active document</a> of the <a href=#browsing-context id=origin:browsing-context>browsing
     context</a> being navigated when the <a href=#navigate id=origin:navigate-3>navigate</a> algorithm was invoked.<dt>If the <code id=origin:document-14><a href=#document>Document</a></code> is <a href=#an-iframe-srcdoc-document id=origin:an-iframe-srcdoc-document>an <code>iframe</code> <code>srcdoc</code> document</a><dd><p>The <a href=#concept-origin id=origin:concept-origin-9>origin</a> of the <code id=origin:document-15><a href=#document>Document</a></code>'s <a href=#concept-document-bc id=origin:concept-document-bc>browsing context</a>'s <a href=#browsing-context-container id=origin:browsing-context-container>browsing context
     container</a>'s <a id=origin:node-document-2 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node document</a>.<dt>If the <code id=origin:document-16><a href=#document>Document</a></code> was obtained in some other manner (e.g. a <code id=origin:document-17><a href=#document>Document</a></code>
     created using the <code id=origin:dom-domimplementation-createdocument><a data-x-internal=dom-domimplementation-createdocument href=https://dom.spec.whatwg.org/#dom-domimplementation-createdocument>createDocument()</a></code>
     API, etc)<dd>
      <p>The default behavior as defined in the WHATWG DOM standard applies. <a href=#refsDOM>[DOM]</a>.</p>

      <p class=note>The <a href=#concept-origin id=origin:concept-origin-10>origin</a> is a unique <a href=#concept-origin-opaque id=origin:concept-origin-opaque-3>opaque origin</a> assigned when the <code id=origin:document-18><a href=#document>Document</a></code> is
      created.</p>
     </dl>

   <dt>For images of <code id=origin:the-img-element><a href=#the-img-element>img</a></code> elements<dd>

    <dl class=switch><dt>If the image data is <a href=#cors-cross-origin id=origin:cors-cross-origin>CORS-cross-origin</a><dd><p>A unique <a href=#concept-origin-opaque id=origin:concept-origin-opaque-4>opaque origin</a> assigned when the
     image is created.<dt>If the image data is <a href=#cors-same-origin id=origin:cors-same-origin>CORS-same-origin</a><dd><p>The <code id=origin:the-img-element-2><a href=#the-img-element>img</a></code> element's <a id=origin:node-document-3 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node document</a>'s
     <a href=#concept-origin id=origin:concept-origin-11>origin</a>.</dl>

   <dt>For <code id=origin:the-audio-element><a href=#the-audio-element>audio</a></code> and <code id=origin:the-video-element><a href=#the-video-element>video</a></code> elements<dd>

    <dl class=switch><dt>If the <a href=#media-data id=origin:media-data>media data</a> is <a href=#cors-cross-origin id=origin:cors-cross-origin-2>CORS-cross-origin</a><dd><p>A unique <a href=#concept-origin-opaque id=origin:concept-origin-opaque-5>opaque origin</a> assigned when the
     <a href=#media-data id=origin:media-data-2>media data</a> is fetched.<dt>If the <a href=#media-data id=origin:media-data-3>media data</a> is <a href=#cors-same-origin id=origin:cors-same-origin-2>CORS-same-origin</a><dd><p>The <a href=#media-element id=origin:media-element>media element</a>'s <a id=origin:node-document-4 href=https://dom.spec.whatwg.org/#concept-node-document data-x-internal=node-document>node document</a>'s
     <a href=#concept-origin id=origin:concept-origin-12>origin</a>.</dl>

   </dl>

  <p>Other specifications can override the above definitions by themselves specifying the origin of
  a particular <code id=origin:document-19><a href=#document>Document</a></code> object, image, or <a href=#media-element id=origin:media-element-2>media element</a>.</p>

  <hr>

  <p>The <dfn data-export="" id=unicode-serialisation-of-an-origin>Unicode
  serialization of an origin</dfn> is the string obtained by applying the following algorithm to the
  given <a href=#concept-origin id=origin:concept-origin-13>origin</a> <var>origin</var>:</p>

  <ol><li><p>If <var>origin</var> is an <a href=#concept-origin-opaque id=origin:concept-origin-opaque-6>opaque origin</a>, then
   return "<code>null</code>".<li><p>Let <var>host</var> be <var>origin</var>'s <a href=#concept-origin-host id=origin:concept-origin-host-2>host</a>.<li><p>Let <var>unicodeHost</var> be <var>host</var> if <var>host</var> is not a <a href=https://url.spec.whatwg.org/#concept-domain id=origin:concept-domain-2 data-x-internal=concept-domain>domain</a>, and the result of applying <a id=origin:domain-to-unicode href=https://url.spec.whatwg.org/#concept-domain-to-unicode data-x-internal=domain-to-unicode>domain to Unicode</a>
   to <var>host</var> otherwise.<li><p>Let <var>unicodeOrigin</var> be a new <a href=#concept-origin-tuple id=origin:concept-origin-tuple-3>tuple
   origin</a> consisting <var>origin</var>'s <a href=#concept-origin-scheme id=origin:concept-origin-scheme>scheme</a>,
   <var>unicodeHost</var>, and <var>origin</var>'s <a href=#concept-origin-port id=origin:concept-origin-port>port</a>.<li>
    <p>Return the <a href=#ascii-serialisation-of-an-origin id=origin:ascii-serialisation-of-an-origin-2>ASCII serialization of an origin</a>, given <var>unicodeOrigin</var>.</p>

    <p class=note>The name <a href=#ascii-serialisation-of-an-origin id=origin:ascii-serialisation-of-an-origin-3>ASCII serialization of an origin</a> is misleading, as it
    merely serializes an origin, which are all ASCII by default due to the <a id=origin:url-parser href=https://url.spec.whatwg.org/#concept-url-parser data-x-internal=url-parser>URL
    parser</a>.</p>
   </ol>

  <p class=example>The <a href=#unicode-serialisation-of-an-origin id=origin:unicode-serialisation-of-an-origin>Unicode
  serialization</a> of ("<code>https</code>", "<code>xn--maraa-rta.example</code>", null, null) is "<code>https://maraÃ±a.example</code>".</p>

  <p>The <dfn data-export="" id=ascii-serialisation-of-an-origin>ASCII serialization
  of an origin</dfn> is the string obtained by applying the following algorithm to the given
  <a href=#concept-origin id=origin:concept-origin-14>origin</a> <var>origin</var>:</p>

  <ol><li><p>If <var>origin</var> is an <a href=#concept-origin-opaque id=origin:concept-origin-opaque-7>opaque origin</a>, then
   return "<code>null</code>".<li><p>Otherwise, let <var>result</var> be <var>origin</var>'s <a href=#concept-origin-scheme id=origin:concept-origin-scheme-2>scheme</a>.<li><p>Append "<code>://</code>" to <var>result</var>.<li><p>Append <var>origin</var>'s <a href=#concept-origin-host id=origin:concept-origin-host-3>host</a>, <a href=https://url.spec.whatwg.org/#concept-host-serializer id=origin:host-serializer data-x-internal=host-serializer>serialized</a>, to <var>result</var>.<li><p>If <var>origin</var>'s <a href=#concept-origin-port id=origin:concept-origin-port-2>port</a> is non-null, append
   a U+003A COLON character (:), and <var>origin</var>'s <a href=#concept-origin-port id=origin:concept-origin-port-3>port</a>, <a href=https://url.spec.whatwg.org/#serialize-an-integer id=origin:serialize-an-integer data-x-internal=serialize-an-integer>serialized</a>,
   to <var>result</var>.<li><p>Return <var>result</var>.</ol>

  <hr>

  <p>Two <a href=#concept-origin id=origin:concept-origin-15>origins</a>, <var>A</var> and <var>B</var>, are said to be
  <dfn id=same-origin data-export="">same origin</dfn> if the following algorithm returns true:</p>

  <ol><li><p>If <var>A</var> and <var>B</var> are the same <a href=#concept-origin-opaque id=origin:concept-origin-opaque-8>opaque
   origin</a>, then return true.<li><p>If <var>A</var> and <var>B</var> are both <a href=#concept-origin-tuple id=origin:concept-origin-tuple-4>tuple
   origins</a> and their <a href=#concept-origin-scheme id=origin:concept-origin-scheme-3>schemes</a>, <a href=#concept-origin-host id=origin:concept-origin-host-4>hosts</a>, and <a href=#concept-origin-port id=origin:concept-origin-port-4>port</a> are
   identical, then return true.<li><p>Return false.</ol>

  <p>Two <a href=#concept-origin id=origin:concept-origin-16>origins</a>, <var>A</var> and <var>B</var>, are said to be
  <dfn id=same-origin-domain data-export="">same origin-domain</dfn> if the following algorithm returns true:</p>

  <ol><li><p>If <var>A</var> and <var>B</var> are the same <a href=#concept-origin-opaque id=origin:concept-origin-opaque-9>opaque
   origin</a>, then return true.<li>
    <p>If <var>A</var> and <var>B</var> are both <a href=#concept-origin-tuple id=origin:concept-origin-tuple-5>tuple
    origins</a>, run these substeps:</p>

    <ol><li><p>If <var>A</var> and <var>B</var>'s <a href=#concept-origin-scheme id=origin:concept-origin-scheme-4>schemes</a>
     are identical, and their <a href=#concept-origin-domain id=origin:concept-origin-domain-4>domains</a> are identical and
     non-null, then return true.<li><p>Otherwise, if <var>A</var> and <var>B</var> are <a href=#same-origin id=origin:same-origin>same origin</a> and their <a href=#concept-origin-domain id=origin:concept-origin-domain-5>domains</a> are identical and null, then return
     true.</ol>

   <li><p>Return false.</ol>

  <div class=example>
   <table><tr><th><var>A</var>
     <th><var>B</var>
     <th><a href=#same-origin id=origin:same-origin-2>same origin</a>
     <th><a href=#same-origin-domain id=origin:same-origin-domain>same origin-domain</a>
    <tr><td>("<code>https</code>", "<code>example.org</code>", null, null)
     <td>("<code>https</code>", "<code>example.org</code>", null, null)
     <td>âœ…
     <td>âœ…
    <tr><td>("<code>https</code>", "<code>example.org</code>", 314, null)
     <td>("<code>https</code>", "<code>example.org</code>", 420, null)
     <td>âŒ
     <td>âŒ
    <tr><td>("<code>https</code>", "<code>example.org</code>", 314, "<code>example.org</code>")
     <td>("<code>https</code>", "<code>example.org</code>", 420, "<code>example.org</code>")
     <td>âŒ
     <td>âœ…
    <tr><td>("<code>https</code>", "<code>example.org</code>", null, null)
     <td>("<code>https</code>", "<code>example.org</code>", null, "<code>example.org</code>")
     <td>âœ…
     <td>âŒ
    <tr><td>("<code>https</code>", "<code>example.org</code>", null, "<code>example.org</code>")
     <td>("<code>http</code>", "<code>example.org</code>", null, "<code>example.org</code>")
     <td>âŒ
     <td>âŒ
   </table>
  </div>

  


  <h4 id=relaxing-the-same-origin-restriction>7.5.1 Relaxing the same-origin restriction<a href=#relaxing-the-same-origin-restriction class=self-link></a></h4>

  <dl class=domintro><dt><var>document</var> . <code id=relaxing-the-same-origin-restriction:dom-document-domain><a href=#dom-document-domain>domain</a></code> [ = <var>domain</var> ]<dd>

    <p>Returns the current domain used for security checks.</p>

    <p>Can be set to a value that removes subdomains, to change the <a href=#concept-origin id=relaxing-the-same-origin-restriction:concept-origin>origin</a>'s <a href=#concept-origin-domain id=relaxing-the-same-origin-restriction:concept-origin-domain>domain</a> to allow pages on other subdomains of the same
    domain (if they do the same thing) to access each other. (Can't be set in sandboxed
    <code id=relaxing-the-same-origin-restriction:the-iframe-element><a href=#the-iframe-element>iframe</a></code>s.)</p>

   </dl>

  

  <p>The <dfn id=dom-document-domain><code>domain</code></dfn> attribute's getter must run
  these steps:</p>

  <ol><li><p>If this <code id=relaxing-the-same-origin-restriction:document><a href=#document>Document</a></code> object does not have a <a href=#concept-document-bc id=relaxing-the-same-origin-restriction:concept-document-bc>browsing context</a>, then return the empty string.

   <li><p>Let <var>effectiveDomain</var> be this <code id=relaxing-the-same-origin-restriction:document-2><a href=#document>Document</a></code>'s <a href=#concept-origin id=relaxing-the-same-origin-restriction:concept-origin-2>origin</a>'s <a href=#concept-origin-effective-domain id=relaxing-the-same-origin-restriction:concept-origin-effective-domain>effective domain</a>.

   <li><p>If <var>effectiveDomain</var> is an <a href=#concept-origin-opaque id=relaxing-the-same-origin-restriction:concept-origin-opaque>opaque
   origin</a>, then return the empty string.<li><p>Return <var>effectiveDomain</var>, <a href=https://url.spec.whatwg.org/#concept-host-serializer id=relaxing-the-same-origin-restriction:host-serializer data-x-internal=host-serializer>serialized</a>.</ol>

  <p>The <code id=relaxing-the-same-origin-restriction:dom-document-domain-2><a href=#dom-document-domain>domain</a></code> attribute's setter must run these
  steps:</p>

  <ol><li><p>If this <code id=relaxing-the-same-origin-restriction:document-3><a href=#document>Document</a></code> object has no <a href=#concept-document-bc id=relaxing-the-same-origin-restriction:concept-document-bc-2>browsing
   context</a>, then throw a <a id=relaxing-the-same-origin-restriction:securityerror href=https://heycam.github.io/webidl/#securityerror data-x-internal=securityerror>"<code>SecurityError</code>"</a>
   <code id=relaxing-the-same-origin-restriction:domexception><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code>.<li><p>If this <code id=relaxing-the-same-origin-restriction:document-4><a href=#document>Document</a></code> object's <a href=#active-sandboxing-flag-set id=relaxing-the-same-origin-restriction:active-sandboxing-flag-set>active sandboxing flag set</a> has its
   <a href=#sandboxed-document.domain-browsing-context-flag id=relaxing-the-same-origin-restriction:sandboxed-document.domain-browsing-context-flag>sandboxed <code>document.domain</code> browsing context
   flag</a> set, then throw a <a id=relaxing-the-same-origin-restriction:securityerror-2 href=https://heycam.github.io/webidl/#securityerror data-x-internal=securityerror>"<code>SecurityError</code>"</a>
   <code id=relaxing-the-same-origin-restriction:domexception-2><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code>.<li><p>If the given value is the empty string, then throw a
   <a id=relaxing-the-same-origin-restriction:securityerror-3 href=https://heycam.github.io/webidl/#securityerror data-x-internal=securityerror>"<code>SecurityError</code>"</a> <code id=relaxing-the-same-origin-restriction:domexception-3><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code>.<li><p>Let <var>host</var> be the result of <a href=https://url.spec.whatwg.org/#concept-host-parser id=relaxing-the-same-origin-restriction:host-parser data-x-internal=host-parser>parsing</a> the given
   value.<li><p>If <var>host</var> is failure, then throw a <a id=relaxing-the-same-origin-restriction:securityerror-4 href=https://heycam.github.io/webidl/#securityerror data-x-internal=securityerror>"<code>SecurityError</code>"</a>
   <code id=relaxing-the-same-origin-restriction:domexception-4><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code>.<li><p>Let <var>effectiveDomain</var> be this <code id=relaxing-the-same-origin-restriction:document-5><a href=#document>Document</a></code> object's
   <a href=#concept-origin id=relaxing-the-same-origin-restriction:concept-origin-3>origin</a>'s <a href=#concept-origin-effective-domain id=relaxing-the-same-origin-restriction:concept-origin-effective-domain-2>effective
   domain</a>.<li>
    <p>If <var>host</var> is <em>not</em> <a href=https://url.spec.whatwg.org/#concept-host-equals id=relaxing-the-same-origin-restriction:host-equals data-x-internal=host-equals>equal</a> to
    <var>effectiveDomain</var>, then run these substeps:</p>

    <ol><li>
      <p>If <var>host</var> or <var>effectiveDomain</var> is not a <a href=https://url.spec.whatwg.org/#concept-domain id=relaxing-the-same-origin-restriction:concept-domain data-x-internal=concept-domain>domain</a>, then throw a <a id=relaxing-the-same-origin-restriction:securityerror-5 href=https://heycam.github.io/webidl/#securityerror data-x-internal=securityerror>"<code>SecurityError</code>"</a>
      <code id=relaxing-the-same-origin-restriction:domexception-5><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code>.</p>

      <p class=note>This is meant to exclude <a href=https://url.spec.whatwg.org/#concept-host id=relaxing-the-same-origin-restriction:concept-host data-x-internal=concept-host>hosts</a> that are an
      <a id=relaxing-the-same-origin-restriction:ipv4-address href=https://url.spec.whatwg.org/#concept-ipv4 data-x-internal=ipv4-address>IPv4 address</a> or an <a id=relaxing-the-same-origin-restriction:ipv6-address href=https://url.spec.whatwg.org/#concept-ipv6 data-x-internal=ipv6-address>IPv6 address</a>.</p>
     <li><p>If <var>host</var>, prefixed by a U+002E FULL STOP (.), does not exactly match the end
     of <var>effectiveDomain</var>, then throw a <a id=relaxing-the-same-origin-restriction:securityerror-6 href=https://heycam.github.io/webidl/#securityerror data-x-internal=securityerror>"<code>SecurityError</code>"</a>
     <code id=relaxing-the-same-origin-restriction:domexception-6><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code>.<li>
      <p>If <var>host</var> matches a suffix in the Public Suffix List, or, if <var>host</var>,
      prefixed by a U+002E FULL STOP (.), matches the end of a suffix in the Public Suffix List,
      then throw a <a id=relaxing-the-same-origin-restriction:securityerror-7 href=https://heycam.github.io/webidl/#securityerror data-x-internal=securityerror>"<code>SecurityError</code>"</a> <code id=relaxing-the-same-origin-restriction:domexception-7><a data-x-internal=domexception href=https://heycam.github.io/webidl/#dfn-DOMException>DOMException</a></code>. <a href=#refsPSL>[PSL]</a></p>

      <p>Suffixes must be compared after applying the <a id=relaxing-the-same-origin-restriction:host-parser-2 href=https://url.spec.whatwg.org/#concept-host-parser data-x-internal=host-parser>host parser</a> algorithm.</p>
     </ol>
   <li><p>Set this <code id=relaxing-the-same-origin-restriction:document-6><a href=#document>Document</a></code> object's <a href=#concept-origin id=relaxing-the-same-origin-restriction:concept-origin-4>origin</a>'s <a href=#concept-origin-domain id=relaxing-the-same-origin-restriction:concept-origin-domain-2>domain</a> to <var>host</var>.</ol>

  

  <p class=note>The <code id=relaxing-the-same-origin-restriction:dom-document-domain-3><a href=#dom-document-domain>document.domain</a></code> attribute is used to
  enable pages on different hosts of a domain to access each other's DOMs.</p>

  <p class=warning>Do not use the <code id=relaxing-the-same-origin-restriction:dom-document-domain-4><a href=#dom-document-domain>document.domain</a></code>
  attribute when using shared hosting. If an untrusted third party is able to host an HTTP server at
  the same IP address but on a different port, then the same-origin protection that normally
  protects two different sites on the same host will fail, as the ports are ignored when comparing
  origins after the <code id=relaxing-the-same-origin-restriction:dom-document-domain-5><a href=#dom-document-domain>document.domain</a></code> attribute has been
  used.</p>





  <h3 id=sandboxing>7.6 Sandboxing<a href=#sandboxing class=self-link></a></h3>

  <p>A <dfn id=sandboxing-flag-set data-export="">sandboxing flag set</dfn> is a set of zero or more of the following
  flags, which are used to restrict the abilities that potentially untrusted resources have:</p>

  <dl><dt>The <dfn id=sandboxed-navigation-browsing-context-flag data-export="">sandboxed navigation browsing context flag</dfn><dd>

    <p>This flag <a href=#sandboxLinks>prevents content from navigating browsing contexts other
    than the sandboxed browsing context itself</a> (or browsing contexts further nested inside it),
    <a href=#auxiliary-browsing-context id=sandboxing:auxiliary-browsing-context>auxiliary browsing contexts</a> (which are protected
    by the <a href=#sandboxed-auxiliary-navigation-browsing-context-flag id=sandboxing:sandboxed-auxiliary-navigation-browsing-context-flag>sandboxed auxiliary navigation browsing context flag</a> defined next), and the
    <a href=#top-level-browsing-context id=sandboxing:top-level-browsing-context>top-level browsing context</a> (which is protected by the <a href=#sandboxed-top-level-navigation-browsing-context-flag id=sandboxing:sandboxed-top-level-navigation-browsing-context-flag>sandboxed top-level
    navigation browsing context flag</a> defined below).</p>

    <p>If the <a href=#sandboxed-auxiliary-navigation-browsing-context-flag id=sandboxing:sandboxed-auxiliary-navigation-browsing-context-flag-2>sandboxed auxiliary navigation browsing context flag</a> is not set, then in
    certain cases the restrictions nonetheless allow popups (new <a href=#top-level-browsing-context id=sandboxing:top-level-browsing-context-2>top-level browsing contexts</a>) to be opened. These <a href=#browsing-context id=sandboxing:browsing-context>browsing contexts</a> always have <dfn id=one-permitted-sandboxed-navigator>one permitted sandboxed navigator</dfn>, set
    when the browsing context is created, which allows the <a href=#browsing-context id=sandboxing:browsing-context-2>browsing context</a> that
    created them to actually navigate them. (Otherwise, the <a href=#sandboxed-navigation-browsing-context-flag id=sandboxing:sandboxed-navigation-browsing-context-flag>sandboxed navigation browsing
    context flag</a> would prevent them from being navigated even if they were opened.)</p>

   <dt>The <dfn id=sandboxed-auxiliary-navigation-browsing-context-flag data-export="">sandboxed auxiliary navigation browsing context flag</dfn><dd>

    <p>This flag <a href=#sandboxWindowOpen>prevents content from creating new auxiliary browsing
    contexts</a>, e.g. using the <code id=sandboxing:attr-hyperlink-target><a href=#attr-hyperlink-target>target</a></code> attribute or
    the <code id=sandboxing:dom-open><a href=#dom-open>window.open()</a></code> method.</p>

   <dt>The <dfn id=sandboxed-top-level-navigation-browsing-context-flag data-export="">sandboxed top-level navigation browsing context flag</dfn><dd>

    <p>This flag <a href=#sandboxLinks>prevents content from navigating their <span>top-level
    browsing context</span></a> and <a href=#sandboxClose>prevents content from closing their
    <span>top-level browsing context</span></a>.</p>

    <p>When the <a href=#sandboxed-top-level-navigation-browsing-context-flag id=sandboxing:sandboxed-top-level-navigation-browsing-context-flag-2>sandboxed top-level navigation browsing context flag</a> is <em>not</em>
    set, content can navigate its <a href=#top-level-browsing-context id=sandboxing:top-level-browsing-context-3>top-level browsing context</a>, but other <a href=#browsing-context id=sandboxing:browsing-context-3>browsing contexts</a> are still protected by the <a href=#sandboxed-navigation-browsing-context-flag id=sandboxing:sandboxed-navigation-browsing-context-flag-2>sandboxed
    navigation browsing context flag</a> and possibly the <a href=#sandboxed-auxiliary-navigation-browsing-context-flag id=sandboxing:sandboxed-auxiliary-navigation-browsing-context-flag-3>sandboxed auxiliary navigation
    browsing context flag</a>.</p>

   <dt>The <dfn id=sandboxed-plugins-browsing-context-flag data-export="">sandboxed plugins browsing context flag</dfn><dd>

    <p>This flag prevents content from instantiating <a href=#plugin id=sandboxing:plugin>plugins</a>, whether
    using <a href=#sandboxPluginEmbed>the <code>embed</code> element</a>, <a href=#sandboxPluginObject>the <code>object</code> element</a>, <a href=#sandboxPluginApplet>the <code>applet</code> element</a>, or through <a href=#sandboxPluginNavigate>navigation</a> of a <a href=#nested-browsing-context id=sandboxing:nested-browsing-context>nested browsing context</a>, unless
    those <a href=#plugin id=sandboxing:plugin-2>plugins</a> can be <a href=#concept-plugin-secure id=sandboxing:concept-plugin-secure>secured</a>.</p>

   <dt>The <dfn id=sandboxed-origin-browsing-context-flag data-export="">sandboxed origin browsing context flag</dfn><dd>

    <p>This flag <a href=#sandboxOrigin>forces content into a unique origin</a>, thus preventing
    it from accessing other content from the same <a href=#concept-origin id=sandboxing:concept-origin>origin</a>.</p>

    <p>This flag also <a href=#sandboxCookies>prevents script from reading from or writing to the
    <code>document.cookie</code> IDL attribute</a>, and blocks access to
    <code id=sandboxing:dom-localstorage><a href=#dom-localstorage>localStorage</a></code>.</p>

   <dt>The <dfn id=sandboxed-forms-browsing-context-flag data-export="">sandboxed forms browsing context flag</dfn><dd>

    <p>This flag <a href=#sandboxSubmitBlocked>blocks form submission</a>.</p>

   <dt>The <dfn id=sandboxed-pointer-lock-browsing-context-flag data-export="">sandboxed pointer lock browsing context flag</dfn><dd>

    <p>This flag disables the Pointer Lock API. <a href=#refsPOINTERLOCK>[POINTERLOCK]</a></p>

   <dt>The <dfn id=sandboxed-scripts-browsing-context-flag data-export="">sandboxed scripts browsing context flag</dfn><dd>

    <p>This flag <a href=#sandboxScriptBlocked>blocks script execution</a>.</p>

   <dt>The <dfn id=sandboxed-automatic-features-browsing-context-flag data-export="">sandboxed automatic features browsing context flag</dfn><dd>

    <p>This flag blocks features that trigger automatically, such as <a href=#attr-media-autoplay id=sandboxing:attr-media-autoplay>automatically playing a video</a> or <a href=#attr-fe-autofocus id=sandboxing:attr-fe-autofocus>automatically focusing a form control</a>.</p>

   <dt>The <dfn id=sandboxed-storage-area-urls-flag data-export="">sandboxed storage area URLs flag</dfn><dd>

    <p>This flag prevents URL schemes that use storage areas from being able to access the origin's
    data.</p>

   <dt>The <dfn id=sandboxed-document.domain-browsing-context-flag data-export="">sandboxed <code>document.domain</code>
   browsing context flag</dfn><dd>

    <p>This flag prevents content from using the
    <code id=sandboxing:dom-document-domain><a href=#dom-document-domain>document.domain</a></code> setter.</p>

   <dt>The <dfn id=sandbox-propagates-to-auxiliary-browsing-contexts-flag data-export="">sandbox propagates to auxiliary browsing contexts flag</dfn><dd>

    <p>This flag prevents content from escaping the sandbox by ensuring that any
    <a href=#auxiliary-browsing-context id=sandboxing:auxiliary-browsing-context-2>auxiliary browsing context</a> it creates inherits the content's
    <a href=#active-sandboxing-flag-set id=sandboxing:active-sandboxing-flag-set>active sandboxing flag set</a>.</p>

   <dt>The <dfn id=sandboxed-modals-flag data-export="">sandboxed modals flag</dfn><dd>

    <p>This flag prevents content from using any of the following features to produce modal
    dialogs:</p>

    <ul><li><code id=sandboxing:dom-alert><a href=#dom-alert>window.alert()</a></code><li><code id=sandboxing:dom-confirm><a href=#dom-confirm>window.confirm()</a></code><li><code id=sandboxing:dom-print><a href=#dom-print>window.print()</a></code><li><code id=sandboxing:dom-prompt><a href=#dom-prompt>window.prompt()</a></code><li>the <code id=sandboxing:event-beforeunload><a href=#event-beforeunload>beforeunload</a></code> event</ul>

   <dt>The <dfn id=sandboxed-orientation-lock-browsing-context-flag data-export="">sandboxed orientation lock browsing context flag</dfn><dd>

    <p>This flag disables the ability to lock the screen orientation. <a href=#refsSCREENORIENTATION>[SCREENORIENTATION]</a></p>

   <dt>The <dfn id=sandboxed-presentation-browsing-context-flag data-export="">sandboxed presentation browsing context flag</dfn><dd>

    <p>This flag disables the Presentation API. <a href=#refsPRESENTATION>[PRESENTATION]</a></p>

   </dl>

  <p>When the user agent is to <dfn id=parse-a-sandboxing-directive data-export="">parse a sandboxing directive</dfn>, given a
  string <var>input</var>, a <a href=#sandboxing-flag-set id=sandboxing:sandboxing-flag-set>sandboxing flag set</a> <var>output</var>, it must run the
  following steps:</p>

  <ol><li><p><a href=#split-a-string-on-spaces id=sandboxing:split-a-string-on-spaces>Split <var>input</var> on spaces</a>,
   to obtain <var>tokens</var>.<li><p>Let <var>output</var> be empty.<li>

    <p>Add the following flags to <var>output</var>:</p>

    <ul><li><p>The <a href=#sandboxed-navigation-browsing-context-flag id=sandboxing:sandboxed-navigation-browsing-context-flag-3>sandboxed navigation browsing context flag</a>.<li><p>The <a href=#sandboxed-auxiliary-navigation-browsing-context-flag id=sandboxing:sandboxed-auxiliary-navigation-browsing-context-flag-4>sandboxed auxiliary navigation browsing context flag</a>, unless <var>tokens</var> contains the <dfn id=attr-iframe-sandbox-allow-popups><code>allow-popups</code></dfn> keyword.<li><p>The <a href=#sandboxed-top-level-navigation-browsing-context-flag id=sandboxing:sandboxed-top-level-navigation-browsing-context-flag-3>sandboxed top-level navigation browsing context flag</a>, unless <var>tokens</var> contains the <dfn id=attr-iframe-sandbox-allow-top-navigation><code>allow-top-navigation</code></dfn>
     keyword.<li><p>The <a href=#sandboxed-plugins-browsing-context-flag id=sandboxing:sandboxed-plugins-browsing-context-flag>sandboxed plugins browsing context flag</a>.<li>

      <p>The <a href=#sandboxed-origin-browsing-context-flag id=sandboxing:sandboxed-origin-browsing-context-flag>sandboxed origin browsing context flag</a>, unless the <var>tokens</var> contains the <dfn id=attr-iframe-sandbox-allow-same-origin><code>allow-same-origin</code></dfn>
      keyword.</p>

      <div class=note>

       <p>The <code id=sandboxing:attr-iframe-sandbox-allow-same-origin><a href=#attr-iframe-sandbox-allow-same-origin>allow-same-origin</a></code> keyword
       is intended for two cases.</p>

       <p>First, it can be used to allow content from the same site to be sandboxed to disable
       scripting, while still allowing access to the DOM of the sandboxed content.</p>

       <p>Second, it can be used to embed content from a third-party site, sandboxed to prevent that
       site from opening pop-up windows, etc, without preventing the embedded page from
       communicating back to its originating site, using the database APIs to store data, etc.</p>

      </div>

     <li><p>The <a href=#sandboxed-forms-browsing-context-flag id=sandboxing:sandboxed-forms-browsing-context-flag>sandboxed forms browsing context flag</a>, unless <var>tokens</var> contains the <dfn id=attr-iframe-sandbox-allow-forms><code>allow-forms</code></dfn> keyword.<li><p>The <a href=#sandboxed-pointer-lock-browsing-context-flag id=sandboxing:sandboxed-pointer-lock-browsing-context-flag>sandboxed pointer lock browsing context flag</a>, unless <var>tokens</var> contains the <dfn id=attr-iframe-sandbox-allow-pointer-lock><code>allow-pointer-lock</code></dfn>
     keyword.<li><p>The <a href=#sandboxed-scripts-browsing-context-flag id=sandboxing:sandboxed-scripts-browsing-context-flag>sandboxed scripts browsing context flag</a>, unless <var>tokens</var> contains the <dfn id=attr-iframe-sandbox-allow-scripts><code>allow-scripts</code></dfn> keyword.<li>

      <p>The <a href=#sandboxed-automatic-features-browsing-context-flag id=sandboxing:sandboxed-automatic-features-browsing-context-flag>sandboxed automatic features browsing context flag</a>, unless <var>tokens</var> contains the <code id=sandboxing:attr-iframe-sandbox-allow-scripts><a href=#attr-iframe-sandbox-allow-scripts>allow-scripts</a></code> keyword (defined above).</p>

      <p class=note>This flag is relaxed by the same keyword as scripts, because when scripts are
      enabled these features are trivially possible anyway, and it would be unfortunate to force
      authors to use script to do them when sandboxed rather than allowing them to use the
      declarative features.</p>

     <li><p>The <a href=#sandboxed-storage-area-urls-flag id=sandboxing:sandboxed-storage-area-urls-flag>sandboxed storage area URLs flag</a>.<li><p>The <a href=#sandboxed-document.domain-browsing-context-flag id=sandboxing:sandboxed-document.domain-browsing-context-flag>sandboxed <code>document.domain</code> browsing
     context flag</a>.<li><p>The <a href=#sandbox-propagates-to-auxiliary-browsing-contexts-flag id=sandboxing:sandbox-propagates-to-auxiliary-browsing-contexts-flag>sandbox propagates to auxiliary browsing contexts flag</a>, unless
     <var>tokens</var> contains the <dfn id=attr-iframe-sandbox-allow-popups-to-escape-sandbox><code>allow-popups-to-escape-sandbox</code></dfn>
     keyword.<li><p>The <a href=#sandboxed-modals-flag id=sandboxing:sandboxed-modals-flag>sandboxed modals flag</a>, unless <var>tokens</var> contains the <dfn id=attr-iframe-sandbox-allow-modals><code>allow-modals</code></dfn> keyword.<li><p>The <a href=#sandboxed-orientation-lock-browsing-context-flag id=sandboxing:sandboxed-orientation-lock-browsing-context-flag>sandboxed orientation lock browsing context flag</a>, unless
     <var>tokens</var> contains the <dfn id=attr-iframe-sandbox-allow-orientation-lock><code>allow-orientation-lock</code></dfn>
     keyword.<li><p>The <a href=#sandboxed-presentation-browsing-context-flag id=sandboxing:sandboxed-presentation-browsing-context-flag>sandboxed presentation browsing context flag</a>, unless <var>tokens</var>
     contains the <dfn id=attr-iframe-sandbox-allow-presentation><code>allow-presentation</code></dfn>
     keyword.</ul>

   </ol>

  <hr>

  <p>Every <a href=#top-level-browsing-context id=sandboxing:top-level-browsing-context-4>top-level browsing context</a> has a <dfn id=popup-sandboxing-flag-set>popup sandboxing flag set</dfn>, which
  is a <a href=#sandboxing-flag-set id=sandboxing:sandboxing-flag-set-2>sandboxing flag set</a>. When a <a href=#browsing-context id=sandboxing:browsing-context-4>browsing context</a> is created, its
  <a href=#popup-sandboxing-flag-set id=sandboxing:popup-sandboxing-flag-set>popup sandboxing flag set</a> must be empty. It is populated by <a href=#the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name id=sandboxing:the-rules-for-choosing-a-browsing-context-given-a-browsing-context-name>the rules for
  choosing a browsing context given a browsing context name</a>.</p>

  <p>Every <a href=#browsing-context id=sandboxing:browsing-context-5>browsing context</a> that is a <a href=#nested-browsing-context id=sandboxing:nested-browsing-context-2>nested browsing context</a> has an
  <dfn id=iframe-sandboxing-flag-set><code>iframe</code> sandboxing flag set</dfn>, which is a <a href=#sandboxing-flag-set id=sandboxing:sandboxing-flag-set-3>sandboxing flag set</a>.
  Which flags in a <a href=#nested-browsing-context id=sandboxing:nested-browsing-context-3>nested browsing context</a>'s <a href=#iframe-sandboxing-flag-set id=sandboxing:iframe-sandboxing-flag-set><code>iframe</code> sandboxing flag
  set</a> are set at any particular time is determined by the <code id=sandboxing:the-iframe-element><a href=#the-iframe-element>iframe</a></code> element's <code id=sandboxing:attr-iframe-sandbox><a href=#attr-iframe-sandbox>sandbox</a></code> attribute.</p>

  <p>Every <code id=sandboxing:document><a href=#document>Document</a></code> has an <dfn id=active-sandboxing-flag-set>active sandboxing flag set</dfn>, which is a
  <a href=#sandboxing-flag-set id=sandboxing:sandboxing-flag-set-4>sandboxing flag set</a>. When the <code id=sandboxing:document-2><a href=#document>Document</a></code> is created, its <a href=#active-sandboxing-flag-set id=sandboxing:active-sandboxing-flag-set-2>active
  sandboxing flag set</a> must be empty. It is populated by the <a href=#navigate id=sandboxing:navigate>navigation
  algorithm</a>.</p>

  <p>Every resource that is obtained by the <a href=#navigate id=sandboxing:navigate-2>navigation algorithm</a> has
  a <dfn id=forced-sandboxing-flag-set data-export="">forced sandboxing flag set</dfn>, which is a <a href=#sandboxing-flag-set id=sandboxing:sandboxing-flag-set-5>sandboxing flag
  set</a>. A resource by default has no flags set in its <a href=#forced-sandboxing-flag-set id=sandboxing:forced-sandboxing-flag-set>forced sandboxing flag set</a>,
  but other specifications can define that certain flags are set.</p>

  <p class=note>In particular, the <a href=#forced-sandboxing-flag-set id=sandboxing:forced-sandboxing-flag-set-2>forced sandboxing flag set</a> is used by
  <cite>Content Security Policy</cite>. <a href=#refsCSP>[CSP]</a></p>

  <hr>

  <p>To <dfn id=implement-the-sandboxing>implement the sandboxing</dfn> for a <code id=sandboxing:document-3><a href=#document>Document</a></code> object <var>document</var>,
  populate <var>document</var>'s <a href=#active-sandboxing-flag-set id=sandboxing:active-sandboxing-flag-set-3>active sandboxing flag set</a> with the union of the flags
  that are present in the following <a href=#sandboxing-flag-set id=sandboxing:sandboxing-flag-set-6>sandboxing flag
  sets</a>:</p>

  <ul><li><p>If <var>document</var>'s <a href=#concept-document-bc id=sandboxing:concept-document-bc>browsing context</a> is a
   <a href=#top-level-browsing-context id=sandboxing:top-level-browsing-context-5>top-level browsing context</a>, then: the flags set on the <a href=#browsing-context id=sandboxing:browsing-context-6>browsing
   context</a>'s <a href=#popup-sandboxing-flag-set id=sandboxing:popup-sandboxing-flag-set-2>popup sandboxing flag set</a>.<li><p>If <var>document</var>'s <a href=#concept-document-bc id=sandboxing:concept-document-bc-2>browsing context</a> is a
   <a href=#nested-browsing-context id=sandboxing:nested-browsing-context-4>nested browsing context</a>, then: the flags set on the <a href=#browsing-context id=sandboxing:browsing-context-7>browsing context</a>'s
   <a href=#iframe-sandboxing-flag-set id=sandboxing:iframe-sandboxing-flag-set-2><code>iframe</code> sandboxing flag set</a>.<li><p>If <var>document</var>'s <a href=#concept-document-bc id=sandboxing:concept-document-bc-3>browsing context</a> is a
   <a href=#nested-browsing-context id=sandboxing:nested-browsing-context-5>nested browsing context</a>, then: the flags set on the <a href=#browsing-context id=sandboxing:browsing-context-8>browsing context</a>'s
   <a href=#parent-browsing-context id=sandboxing:parent-browsing-context>parent browsing context</a>'s <a href=#active-document id=sandboxing:active-document>active document</a>'s <a href=#active-sandboxing-flag-set id=sandboxing:active-sandboxing-flag-set-4>active sandboxing
   flag set</a>.<li><p>The flags set on <var>document</var>'s resource's <a href=#forced-sandboxing-flag-set id=sandboxing:forced-sandboxing-flag-set-3>forced sandboxing flag set</a>,
   if it has one.</ul>



  <h3 id=history>7.7 Session history and navigation<a href=#history class=self-link></a></h3>

  <h4 id=the-session-history-of-browsing-contexts>7.7.1 The session history of browsing contexts<a href=#the-session-history-of-browsing-contexts class=self-link></a></h4>

  <p>The sequence of <code id=the-session-history-of-browsing-contexts:document><a href=#document>Document</a></code>s in a <a href=#browsing-context id=the-session-history-of-browsing-contexts:browsing-context>browsing context</a> is its <dfn id=session-history>session
  history</dfn>. Each <a href=#browsing-context id=the-session-history-of-browsing-contexts:browsing-context-2>browsing context</a>, including <a href=#nested-browsing-context id=the-session-history-of-browsing-contexts:nested-browsing-context>nested browsing contexts</a>, has a distinct session history. A <a href=#browsing-context id=the-session-history-of-browsing-contexts:browsing-context-3>browsing
  context</a>'s session history consists of a flat list of <a href=#session-history-entry id=the-session-history-of-browsing-contexts:session-history-entry>session history entries</a>. Each <dfn id=session-history-entry>session history entry</dfn> consists, at a
  minimum, of a <a id=the-session-history-of-browsing-contexts:url href=https://url.spec.whatwg.org/#concept-url data-x-internal=url>URL</a>, and each entry may in addition have a <a href=#state-object id=the-session-history-of-browsing-contexts:state-object>state object</a>, a
  title, a <code id=the-session-history-of-browsing-contexts:document-2><a href=#document>Document</a></code> object, form data, a <a href=#scroll-restoration-mode id=the-session-history-of-browsing-contexts:scroll-restoration-mode>scroll restoration mode</a>, a scroll
  position, a <a href=#browsing-context-name id=the-session-history-of-browsing-contexts:browsing-context-name>browsing context name</a>, and other information associated with it.</p>

  <p class=note>Each entry, when first created, has a <code id=the-session-history-of-browsing-contexts:document-3><a href=#document>Document</a></code>. However, when a
  <code id=the-session-history-of-browsing-contexts:document-4><a href=#document>Document</a></code> is not <a href=#fully-active id=the-session-history-of-browsing-contexts:fully-active>active</a>, it's possible for it to be
  <a href=#discard-a-document id=the-session-history-of-browsing-contexts:discard-a-document>discarded</a> to free resources. The <a id=the-session-history-of-browsing-contexts:url-2 href=https://url.spec.whatwg.org/#concept-url data-x-internal=url>URL</a> and
  other data in a <a href=#session-history-entry id=the-session-history-of-browsing-contexts:session-history-entry-2>session history entry</a> is then used to bring a new
  <code id=the-session-history-of-browsing-contexts:document-5><a href=#document>Document</a></code> into being to take the place of the original, should the user agent find
  itself having to reactivate that <code id=the-session-history-of-browsing-contexts:document-6><a href=#document>Document</a></code>.</p>

  <p class=note>Titles associated with <a href=#session-history-entry id=the-session-history-of-browsing-contexts:session-history-entry-3>session history
  entries</a> need not have any relation with the current <code id=the-session-history-of-browsing-contexts:the-title-element><a href=#the-title-element>title</a></code> of the
  <code id=the-session-history-of-browsing-contexts:document-7><a href=#document>Document</a></code>. The title of a <a href=#session-history-entry id=the-session-history-of-browsing-contexts:session-history-entry-4>session history entry</a> is intended to explain
  the state of the document at that point, so that the user can navigate the document's history.</p>

  <p>URLs without associated <a href=#state-object id=the-session-history-of-browsing-contexts:state-object-2>state objects</a> are added to the
  session history as the user (or script) navigates from page to page.</p>

  <hr>

  <p>Each <code id=the-session-history-of-browsing-contexts:document-8><a href=#document>Document</a></code> object in a <a href=#browsing-context id=the-session-history-of-browsing-contexts:browsing-context-4>browsing context</a>'s <a href=#session-history id=the-session-history-of-browsing-contexts:session-history>session
  history</a> is associated with a unique <code id=the-session-history-of-browsing-contexts:history-3><a href=#history-3>History</a></code> object which must all model the
  same underlying <a href=#session-history id=the-session-history-of-browsing-contexts:session-history-2>session history</a>.</p>

  

  <p>The <dfn id=dom-history><code>history</code></dfn> attribute of the <code id=the-session-history-of-browsing-contexts:window><a href=#window>Window</a></code>
  interface must return the object implementing the <code id=the-session-history-of-browsing-contexts:history-3-2><a href=#history-3>History</a></code> interface for this
  <code id=the-session-history-of-browsing-contexts:window-2><a href=#window>Window</a></code> object's <a href=#concept-document-window id=the-session-history-of-browsing-contexts:concept-document-window>associated
  <code>Document</code></a>.</p>

  

  <hr>

  <p>A <dfn id=state-object>state object</dfn> is an object representing a user interface state.</p>

  <p>Pages can <a href=#dom-history-pushstate id=the-session-history-of-browsing-contexts:dom-history-pushstate>add</a> <a href=#state-object id=the-session-history-of-browsing-contexts:state-object-3>state
  objects</a> to the session history. These are then <a href=#event-popstate id=the-session-history-of-browsing-contexts:event-popstate>returned to the
  script</a> when the user (or script) goes back in the history, thus enabling authors to use the
  "navigation" metaphor even in one-page applications.</p>

  <div class=note>

   <p><a href=#state-object id=the-session-history-of-browsing-contexts:state-object-4>State objects</a> are intended to be used for two main purposes:
   first, storing a preparsed description of the state in the <a id=the-session-history-of-browsing-contexts:url-3 href=https://url.spec.whatwg.org/#concept-url data-x-internal=url>URL</a> so that in the simple
   case an author doesn't have to do the parsing (though one would still need the parsing for
   handling <a href=https://url.spec.whatwg.org/#concept-url id=the-session-history-of-browsing-contexts:url-4 data-x-internal=url>URLs</a> passed around by users, so it's only a minor
   optimization), and second, so that the author can store state that one wouldn't store in the URL
   because it only applies to the current <code id=the-session-history-of-browsing-contexts:document-9><a href=#document>Document</a></code> instance and it would have to be
   reconstructed if a new <code id=the-session-history-of-browsing-contexts:document-10><a href=#document>Document</a></code> were opened.</p>

